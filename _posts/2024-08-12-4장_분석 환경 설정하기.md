---
# Header
title: "4장.분석 환경 설정하기"
excerpt: "분석 환경 설정하기"
name: J
writer: J
categories: [데이터 시각화, GA4 + Power BI + Tableau] # [메인 카테고리, 서브 카테고리]
tags:
  - [Khuda, ML, data]

toc: true
toc_sticky: true

date: 2024-08-13
last_modified_at: 2024-08-13

# --- 아래 부터 content
---
# 4.1 속성 설정: 원천 데이터베이스 설정하기

❗관리 > 속성

### 속성 추가하기

1. 왼쪽 하단의 톱니바퀴 모양의 [관리] 메뉴를 클릭합니다.

![alt text](/assets/img_20240813/image.png)

2. [속성 만들기]를 클릭합니다.

![alt text](/assets/img_20240813/image-1.png)

3. 속성 설정 화면이 나타나면 아래와 같이 입력해줍니다.

![alt text](/assets/img_20240813/image-2.png)

❗UA는 현재 서비스를 종료하였으므로 여기까지만 진행해봅시다.
❗이제부터는 UA를 이용해서 할 수 있는 과정인데 개념 중심으로 정독해주시면 되겠습니다.

4. 이상 없이 진행되었다면 새로운 속성이 만들어집니다. (관리 > 속성 > 추적 정보 > 추적 코드)

![alt text](/assets/img_20240813/image-3.png)

  - (1) '모두의GA_속성(머천다이즈셋팅실습)' 속성이 생성되었습니다. '전체 웹 사이트 데이터' 보기가 자동으로 생성됩니다.
  - (2) 추적 ID(Tracking ID): 데이터를 수집할 때 사용하는 고유 아이디입니다. '추적 ID(UA-XXXXXX-X)'는 속성 고유 아이디로, 변경할 수 없습니다.
  - (3) 상태: 데이터가 수집되는지 여부는 상태를 통해 확인할 수 있습니다. 현재 설정 단계에서는 아직 추적 코드가 삽입되지 않았기 때문에 데이터가 수집되지 않습니다.
  - (4) 웹 사이트 추적: 2장에서 살펴보았던 추적 코드(gtag.js)도 확인할 수 있습니다. 해당 스크립트를 복사해서 웹 페이지마다 삽입하면 데이터가 GA로 전송되기 시작합니다.

### 구글 시그널

❗ 관리 > 속성 > 추적 정보 > 데이터 수집

- 구글 시그널: 구글 제품(크롬, 지메일 등)을 사용할 때 동의한 사용자에 대하여 1명으로 식별할 수 있게 도와주는 기능입니다.(다른 기기에 접속해도 똑같이 'A 사용자'라고 인식할 수 있게해줌)<br> => 개인화 분석, 개인화 서비스, 개인화 마케팅 등 정교한 비지니스 활동이 가능해짐.<br>
     => 리마케팅과 확장된 광고 마케팅 기능 이용 가능

- [관리 > 속성 > 추적 정보 > 데이터 수집]을 클릭하고, 다음 화면에서 [리마케팅]과 [광고 보고서 기능]의 설정 아이콘을 모두 활성화 한다.

![alt text](/assets/img_20240813/image-4.png)

![alt text](/assets/img_20240813/image-5.png)

### 유저 ID 설정하기

❗관리 > 속성 > 추적 정보 > User-ID

![alt text](/assets/img_20240813/image-6.png)

- GA는 스마트폰, PC 등 기기에 대해 쿠키 기반의 **클라이언트 ID**를 부여하고 개인으로 식별함 -> 데이터 분석이나 마케팅 활동이 정확하지 않을 수 있음.<br>
  => 기기에서 공통적으로 이용되는 **유저 ID** 이용

1. 유저 ID 보기를 활성화하려면 [User-ID]메뉴에서 유저 ID 정책에 동의합니다(1). 그리고 [다음 단계] 버튼을 클릭합니다(2).

![alt text](/assets/img_20240813/image-7.png)

2. 세션 통합 활성화 화면이 나타납니다. 사용자가 웹 사이트에 방문해서 로그인하지 않은 상태로 활동하면 GA는 해당 세션이 어떤 사용자인지 알 수 없습니다. 세션 통합을 활성화하면 GA는 사용자가 로그인하는 시점에, 유저 ID를 기준으로 로그인하기 전 사용자의 행동에 대해서도 해당 유저 ID의 세션 활동으로 계산해서 보고서를 제공합니다. [세션 통합]을 활성화합니다(1). 그리고 [다음 단계]를 클릭합니다(2).

![alt text](/assets/img_20240813/image-8.png)

3. 유저 ID 보기를 만드는 화면이 나타납니다. [만들기] 버튼을 클릭해 유저 ID 보기를 생성합니다.

![alt text](/assets/img_20240813/image-9.png)

4. [보고서 속성 보기 이름]에는 'user_id_view'를(1), [보고 시간대]에는 '대한민국'을 지정하고(2), [사용자 ID 보고서 표시] 설정을 활성화하고(3) [보기 만들기] 버튼을 클릭하면(4) 유저 ID 보기가 생성됩니다.

![alt text](/assets/img_20240813/image-10.png)

- 유저 아이디 보기를 활성화하면 유저 ID 관점에서 보고서를 확인할 수 있습니다.

![alt text](/assets/img_20240813/image-11.png)

### 리퍼럴 제외 설정하기

❗관리 > 속성 > 추적 정보 > 추천 제외 목록

- 리퍼럴: '추천'이라는 의미. 외부 웹 사이트에서 우리 웹 사이트로 유입된 트래픽.
  - 트래픽이 유입된 외부 사이트가 어디인지 분석할 때 유용.
  - 분석에 혼선을 주는 트래픽인 리퍼럴 정보는 제외해야함.

![alt text](/assets/img_20240813/image-12.png)

1. [추천 제외 목록] 메뉴에서 [추천 제외]를 클릭합니다.

![alt text](/assets/img_20240813/image-13.png)

2. 도메인을 제외하는 화면이 나타나면 [도메인]에 도메인 주소를 입력합니다(1). [만들기]버튼을 클릭해 저장합니다(2). 생성된 제외 리퍼럴은 트래픽으로 잡히지 않습니다.

![alt text](/assets/img_20240813/image-14.png)

> GA4 리퍼럴 제외 설정하기

❗관리 > 속성 > 데이터 스트림 > (설정하려는) 웹 스트림 정보 > 태그 설정 구성 > 설정(모두 표시) > 원치 않는 추천 나열

![alt text](/assets/img_20240813/image-16.png)
![alt text](/assets/img_20240813/image-15.png)

# 4.2 보기 설정: 분석가 데이터베이스 설정하기

- 보기: 분석가용 데이터 베이스

### 보기 설정

❗ 관리 > 보기 > 보기 설정

![alt text](/assets/img_20240813/image-17.png)

1. 보기의 이름을 바꾸거나(1) 복사 또는 삭제할 수도 있습니다(2). 또, 웹 사이트 URL, 시간대나 국가, 화폐 단위도 변경할 수 있습니다.

![alt text](/assets/img_20240813/image-18.png)

### 봇 필터링/내부 검색 기능 활성화하기

❗계정 > 보기 > 보기 설정

![alt text](/assets/img_20240813/image-19.png)

1. 봇 필터링: 봇으로 알려진 트래픽을 차단합니다. 봇이란 특정 작업이나 프로세스를 자동화하여 실행하는 응용 프로그램을 말하는 것으로 보안상 위협을 주는 프로그램으로 인식됩니다. 불순한 의도로 개인 PC를 원격 조작하거나 표적 공격의 대상이 될 수 있으므로 봇 필터링 기능을 활성화합니다.
2. 사이트 검색 추적: 사용자가 우리 웹 사이트 내에서 키워드를 검색했을 때 해당 키워드를 수집하는 기능을 활성화합니다. 이 기능은 '검색어 보고서'와 관련 있습니다.
3. 검색어 매개변수: 검색어 매개변수(데이터 담는 그릇)는 내부 검색을 실행할 때 붙는 매개변수를 말합니다. 웹 사이트 구조에 따라 매개변수는 다른데, 주로 검색 메뉴의 웹 브라우저 주소창에서 확인할 수 있습니다.

![alt text](/assets/img_20240813/image-20.png)

### 필터 설정

❗관리 > 보기 > 필터

![alt text](/assets/img_20240813/image-21.png)

- 필터: 보기에 어떤 데이터가 어떻게 저장될지 설정하는 기능.

> 사내 트래픽 차단하기

- 사내 트래픽: GA를 다루는 분석가나 GA 코드를 개발하는 개발자.<br>
  => 실제 데이터에 혼선을 줄 수 있음.<br>
  => 특성 주소(IP)로 걸러낼 수 있음.

1. 필터를 추가하려면 [필터 추가]를 클릭합니다.

![alt text](/assets/img_20240813/image-22.png)

2. 필터 설정 상세 화면이 나타납니다. 만약 [새 필터 만들기]와 [기존 필터 적용]이 나타나면 [새 필터 만들기]를 선택한 뒤 '맞춤'(2)을 클릭합니다.

![alt text](/assets/img_20240813/image-23.png)

- (1)필터 이름: 필터 이름을 입력합니다.
- (2)필터 유형: '사전 정의됨'과 '맞춤'이 있는데 '맞춤'을 선택합니다.
- (3)필터 기능: '제외', '포함'등 다양한 유형이 있는데 IP를 제외하는 기능이므로 '제외'를 선택합니다.
- (4)필터 입력란: IP 주소로 제외할 것이므로 'IP 주소'를 선택합니다.
- (5)필터 패턴: 제외될 패턴입니다. IP 주소를 입력하면 됩니다.

> GA4 내부 트래픽 정의하기

❗[ 관리 > 속성 > 데이터 스트림 > (설정하려는) 웹 스트림 정보 > 태그 설정 구성 > 설정(모두 표시) > 내부 트래픽 정의 ] 설정한 뒤 [ 관리 > 속성 > 데이터 설정 > 데이터 필터 > 필터 만들기 > 내부 트래픽]을 만든다.

![alt text](/assets/img_20240813/image-24.png)

![alt text](/assets/img_20240813/image-25.png)

- UA와 유사한 구조이다.

> UA와 GA4 비교

- GA4는 **보기**가 없으므로 **보기 필터** 기능이 없고 **속성 필터** 기능인 데이터 필터 기능만 있습니다(관리 > 속성 > 데이터 설정 > 데이터 필터).
- 개별 이벤트에 로직으로 구현하는 **필터** 기능만이 있음.
- 주요한 GA4 속성 설정 기능
  - 데이터 수집, 보관
  - 데이터 설정: 필터 설정
  - 데이터 가져오기: 외부 데이터를 가져와 GA4에 저장.
  - 기여 분석 설정: 기본 기여 분석 보델을 설정
- **보조 속성**: UA의 보기에 해당.

🔖 UA와 GA4 보기 필터 비교

|구분|UA(GA3)|GA4|
|----|-------|---|
|보기 필터 기능|가능|불가능(보기가 없음)|

# 4.3 전자상거래 설정: 이커머스 설정하기

- 전자상거래: 사용자가 온라인 웹 사이트에 방문하거나 앱을 실행해서 상품을 거래하는 일련의 행위.
- UA에서 전자상거래 분석을 하려면...
  - [보기 설정]에서 전자상거래 기능을 활성화합니다.
  - 전자상거래 정보를 수집하는 추적 코드를 각 구매 단계에 해당하는 웹 페이지를 삽입합니다.

### 전자상거래 활성화

❗ 관리 > 보기 > 전자상거래 설정

![alt text](/assets/img_20240813/image-26.png)
![alt text](/assets/img_20240813/image-27.png)

- [전자상거래 사용]을 설정(활성화)하면 판매한 상품의 수량과 수익만 알 수 있습니다(1). 
- [향상된 전자상거래 보고서 사용 설정]을 활성화하면 기본 구매 외에 사용자가 프로모션을 클릭했는지, 상품을 얼마나 조회하고, 장바구니에 얼마나 담았는지 등 확장된 정보까지 알 수 있습니다(2).

### 전자상거래 데이터 수집 코드 삽입하기

- 코드를 삽입하면 각 구매 단계에서 전자상거래 데이터를 수집할 수 있습니다.
  - 어떤 상품이 많이 팔렸는가?
  - 얼마나 수익이 발생했는가?
  - 각 구매 단계에서 유입과 이탈은 얼마나 되는가?

> 대표적인 전자상거래 데이터 수집 코드 유형

![alt text](/assets/img_20240813/image-28.png)

- 쇼핑 행동 보고서에 보이는 전자상거래 데이터가 어떤 단계에서 어떻게 수집되는지 원리를 아는 것도 중요.

- 전자상거래 데이터는 데이터 수집 코드에 의해 수집.

🔖 UA의 전자상거래 데이터 수집 코드 유형

|전자상거래 수집 코드 유형|내용|
|------------------------|----|
|impressions|사용자가 제품 리스트 페이지(PLP)에 접속했을 때 노출된 제품의 데이터 수집|
|click|사용자가 제품 리스트 페이지(PLP)에서 클릭한 제품의 데이터 수집|
|detail|사용자가 제품 상세 페이지(PDP)에 접속했을 때 노출된 제품의 데이터 수집|
|add|사용자가 제품을 장바구니에 추가했을 때의 데이터 수집|
|remove|사용자가 제품을 장바구니에서 제거했을 때의 데이터 수집|
|checkout|사용자가 결제 정보 페이지에 접속했을 때의 데이터 수집, 단계를 설정할 수 있음|
|purchase|사용자가 제품을 결제했을 때의 데이터 수집|
|refund|사용자가 제품을 환불했을 때의 데이터 수집|

# 4.4 목표 설정: 골 설정하기

- GA4는 이벤트 기반이므로 세션과 관계없이 이벤트 수를 집계합니다.(UA는 하나의 세션에 대해 1개만 집계됩니다.)
- 방문자의 패턴과 행동을 종합하여 목표를 집계하고 이것을 통해 **전환**값(목표를 얼마나 달성했는지)을 구합니다.

> 목표의 종류

|종류|설명|예|
|---|-----|--|
|도착|목표 페이지|/store/buy.html|
|시간|웹 사이트에 머문 시간|10 Min|
|세션당 페이지/화면|세션당 페이지/화면 수|5page/session|
|이벤트|특정 이벤트|Event Action: Video-play|

> 목표 설정

❗관리 > 보기 > 목표

![alt text](/assets/img_20240813/image-29.png)

1. [관리 > 보기 > 목표]로 이동하면 다음 화면이 나타납니다. 이 화면에서 [새 목표(+NEW GOAL)]를 클릭합니다.

![alt text](/assets/img_20240813/image-30.png)

2. 목표 설정: '템플릿'과 '맞춤 설정' 둘 중 하나를 선택할 수 있는데, '템플릿'은 GA가 많이 쓰이는 템플릿을 미리 제공하는 방식이고, '맞춤 설정'은 분석가의 의도대로 설정하는 방식입니다. 보통 '맞춤 설정'을 많이 사용하므로 '맞춤 설정' 항목의 라이도 버튼을 클릭한 뒤(1) [계속] 버튼을 클릭합니다(2).

![alt text](/assets/img_20240813/image-31.png)

3. 목표 설명 설정: 설정할 목표의 세부 사항을 입력하는 화면입니다.

![alt text](/assets/img_20240813/image-32.png)

4. 목표 세부정보 설정: 목표를 세부적으로 설정하는 화면입니다.

![alt text](/assets/img_20240813/image-33.png)

- (1)[최종 목표]를 '정규식'으로 변경한 뒤 '/ordercompleted/.html'을 빈칸에 입력해서 최종 목표의 목적 페이지로 설정하겠습니다. [값]은 다양한 분석을 위한 '전환'에 특정 가치를 부여하는 항목인데 '해제' 상태로 두겠습니다.
- (2)단계별 도달 세션 수를 확인하기 위해 [유입 경로]를 활성화합니다. 이렇게 하면 트래픽의 특정 단계별 흐름을 알 수 있는 퍼널 분석이 가능해집니다. 그 후 [단계]가 나타납니다.
- (3)[단계]에서 퍼널 분석을 위한 각 단계를 설정할 수 있습니다. 

5. 같은 방법으로 다음처럼 값들을 4단계까지 계속 추가합니다(1).

![alt text](/assets/img_20240813/image-34.png)

6. 생성된 목표는 Cart 단계부터 Review 단계까지 거쳐 가는 세션이 최종 단계까지 얼마나 도달했는지를 나타냅니다.

![alt text](/assets/img_20240813/image-35.png)

> UA와 GA4 비교

- GA4에서는 목표 또한 이벤트로 취급. 목표라는 용어 대신 전환 이벤트라고 표현.
- GA4 전환 이벤트는 이벤트를 생성한 뒤 [관리>속성>데이터 표시>이벤트] 메뉴에서 '전환으로 표시'로 설정해 주면 됩니다.
- 전환은 [참여 > 전환수]보고서에서 확인할 수 있다.

![alt text](/assets/img_20240813/image-36.png)

❗ 전환으로 표시하고자 하는 이벤트에, 전환 조건이 적용된 로직이 미리 구현되어야 한다.(GA4)
