---
# Header
title: "1.ì›¹ì—ì„œ ì£¼ë¬¸ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” í…Œí¬ë‹‰ 10"
excerpt: "ì›¹ì—ì„œ ì£¼ë¬¸ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” í…Œí¬ë‹‰ 10"
name: J
writer: J
categories: [ë°ë¹„&ì¶”ì²œì‹œìŠ¤í…œ, íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100] # [ë©”ì¸ ì¹´í…Œê³ ë¦¬, ì„œë¸Œ ì¹´í…Œê³ ë¦¬]
tags:
  - [Khuda, ML, data]

toc: true
toc_sticky: true

date: 2024-09-17
last_modified_at: 2024-09-17

# --- ì•„ë˜ ë¶€í„° content
---

### ì´ìš©í•  ë°ì´í„° ì •ë³´

![alt text](/assets/img_20240918/image.png)

# 001. ë°ì´í„°ë¥¼ ì½ì–´ ë“¤ì´ì

```py
import pandas as pd
# ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒë‹¤ìŠ¤ ì„í¬íŠ¸
customer_master = pd.read_csv('customer_master.csv')
customer_master.head()
# 5í–‰ ì¶œë ¥
```
![alt text](/assets/img_20240918/image-1.png)

```py
item_master = pd.read_csv('item_master.csv')
item_master.head()
```
![alt text](/assets/img_20240918/image-2.png)

```py
transaction_1 = pd.read_csv('transaction_1.csv')
transaction_1.head()
```
![alt text](/assets/img_20240918/image-3.png)

```py
transaction_detail_1 = pd.read_csv('transaction_detail_1.csv')
transaction_detail_1.head()
```
![alt text](/assets/img_20240918/image-4.png)

â—ìƒì„¸í•˜ê²Œ ë‚˜ì™€ ìˆëŠ” ìª½ì— ë§ì¶”ì–´ ë°ì´í„°ë¥¼ ê°€ê³µ.<br>

ğŸ”– transaction_detailì„ ê¸°ì¤€ìœ¼ë¡œ í•  ë•Œ

1. transaction_1ê³¼ transaction_2, ê·¸ë¦¬ê³  transation_detail_1ê³¼ transation_detail_2ë¥¼ ì„¸ë¡œë¡œ ê²°í•©.
2. transaction_detailì„ ê¸°ì¤€ìœ¼ë¡œ, transaction, customer_master, item_masterì„ ê°€ë¡œë¡œ ê²°í•©.

# 002.ë°ì´í„°ë¥¼ ê²°í•©í•´ ë³´ì

â—ê¸°ë³¸ì ìœ¼ë¡œ ê°™ì€ ì‘ì—…ì´ë‹ˆ transaction_1ê³¼ transaction_2ë§Œ ì„¤ëª….

```py
transaction_2 = pd.read_csv('transaction_2')
transaction = pd.concat([transaction_1, transaction_2], ignore_index=True)
# ignore_index: ê¸°ì¡´ ì¸ë±ìŠ¤ë¥¼ ë¬´ì‹œí•˜ê±°ë‚˜ ìœ ì§€
transaction.head()
```
![alt text](/assets/img_20240918/image-5.png)

```py
print(len(transaction_1))
# 5000
print(len(transaction_2))
# 1786
print(len(transaction))
# 6786
```

# 003.ë§¤ì¶œ ë°ì´í„°ë¼ë¦¬ ê²°í•©í•´ ë³´ì

### ìƒê°í• ì 

- ê¸°ì¤€ì´ ë˜ëŠ” ë°ì´í„°ë¥¼ ì •í™•í•˜ê²Œ ê²°ì •, ì–´ë–¤ ì¹¼ëŸ¼ì„ í‚¤ë¡œ ì¡°ì¸í• ì§€ ìƒê°.
1. ë¶€ì¡±í•œ(ì¶”ê°€í•˜ê³  ì‹¶ì€) ë°ì´í„° ì¹¼ëŸ¼ì´ ë¬´ì—‡ì¸ê°€ ìƒê°
2. ê³µí†µë˜ëŠ” ë°ì´í„° ì¹¼ëŸ¼ì€ ë¬´ì—‡ì¸ê°€ë¥¼ ìƒê°

### ì¡°ì¸

```py
join_data = pd.merge(transaction_detail, transaction[["transaction_id", "payment_date", "customer_id"]], on="transaction_id", how="left")
# priceëŠ” transaction_detailì˜ quantityì™€ item_masterì˜ item_priceë¡œë¶€í„° ê³„ì‚°ëœ ê²ƒì…ë‹ˆë‹¤. ì¤‘ë³µí•´ì„œ ê³„ì‚°ë˜ê¸°ì— priceëŠ” ì¶”ê°€x
join_data.head()

print(len(transaction_detail))
# 7144
print(len(transaction))
# 6786
print(len(join_data))
# 7144
```
![alt text](/assets/img_20240918/image-6.png)
â—ì¡°ì¸í•  ë°ì´í„°ì˜ ì¡°ì¸í‚¤ì— ì¤‘ë³µ ë°ì´í„°ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ” ë°ì´í„°ì˜ ê°œìˆ˜ê°€ ëŠ˜ì–´ë‚  ìˆ˜ ìˆìŒ.

- pd.merge
    - ì²«ë²ˆì§¸ ì¸ìˆ˜: ê¸°ì¤€
    - ë‘ë²ˆì§¸ ì¸ìˆ˜: ë³‘í•©í•  ë°ì´í„°
    - on: ì¡°ì¸í‚¤
    - how: ì¡°ì¸ ì¢…ë¥˜

### ë°ì´í„° ì •ê·œí™”

- ì •ê·œí™”: 'ë°ì´í„°ì˜ ì •í•©ì„±(ë°ì´í„°ì— ëŒ€í•´ì„œ, ì»´í“¨í„°ì— ì„¤ì •ëœ ì²˜ë¦¬ ê·œì¹™ê³¼ì˜ ì¼ê´€ì„± ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ê²€ì‚¬)'ì„ ë‹´ë³´í•˜ëŠ” ì„¤ê³„ ì‚¬ìƒ.

ğŸ”–ë¹„ì •ê·œí˜• ë°ì´í„°

![alt text](/assets/img_20240918/image-7.png)

- ë°ì´í„°ê°€ ë°˜ë³µ/ì¤‘ë³µ ì €ì¥.
    => ë°ì´í„°ì˜ í™•ì¥ì„±â¬‡ï¸

ğŸ”–ì •ê·œí™” ì‹œí‚¤ê¸°

- ê±°ë˜ì²˜ ë°ì´í„° ë¶„í• 
    => ë°ì´í„°ì˜ í™•ì¥ì„±â¬†ï¸

![alt text](/assets/img_20240918/image-8.png)

### ë°ì´í„° ê²°í•©ì˜ ì¢…ë¥˜

- ë‚´ë¶€ ê²°í•©(inner join):
    - ê²°í•©í•  2ê°œì˜ ë°ì´í„°ì— ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ë°ì´í„°ë¡œë§Œ êµ¬ì„±.
    - ë‘ ê°œì˜ ë°ì´í„°ì—ì„œ ê³µí†µ ë°ì´í„°ë§Œì„ ì¶”ì¶œ.<br>
    âš ï¸ì •í™•í•˜ê²Œ ê²°í•© ì¡°ê±´ì„ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ë°ì´í„°ì˜ ëˆ„ë½ ë°œìƒ.
- ì™¸ë¶€ ê²°í•©(outer join):
    - ì–´ëŠ í•œ ìª½ë§Œ ì¡´ì¬í•˜ë©´ ë°ì´í„°ê°€ ê²°í•©<br>
    âš ï¸ë°ì´í„° 1ì—ë§Œ ìˆëŠ” ë°ì´í„°ì˜ ë°ì´í„° 2 ë¶€ë¶„ì—ëŠ” ëª¨ë‘ NULLì´ ë“¤ì–´ê°„ë‹¤ëŠ” ì .<br>
    âš ï¸ë ˆì½”ë“œ ìˆ˜ë„ ë¶ˆí•„ìš”í•˜ê²Œ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— ê²°í•© ì¡°ê±´ì„ ì •í™•í•˜ê²Œ ì„¤ì •í•´ì•¼í•¨.
- ë ˆí”„íŠ¸ ì¡°ì¸:
    - ì¢Œì¸¡ì˜ ë°ì´í„°ê°€ ëª¨ë‘ ì‚¬ìš©
- ë¼ì´íŠ¸ ì¡°ì¸: 
    - ìš°ì¸¡ì˜ ë°ì´í„°ê°€ ëª¨ë‘ ì‚¬ìš©
![alt text](/assets/img_20240918/image-9.png)

# 004.ë§ˆìŠ¤í„°ë°ì´í„°ë¥¼ ê²°í•©í•´ ë³´ì

```py
join_data = pd.merge(join_data, customer_master, on="customer_id", how="left")
join_data = pd.merge(join_data, item_master, on="item_id", how="left")
join_data.head()
```

![alt text](/assets/img_20240918/image-10.png)

# 005.í•„ìš”í•œ ë°ì´í„° ì¹¼ëŸ¼ì„ ë§Œë“¤ì

```py
join_data["price"] = join_data["quantity"] * join_data["item_price"]
# ê³±ì…ˆì€ í–‰ë§ˆë‹¤ ê³„ì‚°ì´ ì‹¤í–‰
join_data[["quantity", "item_price", "price"]].head()
# priceë¥¼ ì—´ì„ ê·¸ëƒ¥ ë³‘í•©í•˜ê¸°ì—ëŠ” NULLì´ ìƒê¸¸ìˆ˜ë„ ìˆìœ¼ë‹ˆ ì´ë ‡ê²Œ ê³„ì‚°í•˜ì!
```
![alt text](/assets/img_20240918/image-11.png)

# 006.ë°ì´í„°ë¥¼ ê²€ì‚°í•˜ì

- ë°ì´í„° ê°€ê³µ ì „ transactionì˜ price ì´í•©ê³¼ ë°ì´í„° ê°€ê³µ í›„ì— ê³„ì‚°í•œ priceì˜ ì´í•©ì€ ê°™ì€ ê°’ì´ë‹¤.

```py
print(join_data["price"].sum())
# 971135000
print(transaction["price"].sum())
# 971135000

join_data["price"].sum() == transaction["price"].sum()
# True
```

# 007.ê°ì¢… í†µê³„ëŸ‰ì„ íŒŒì•…í•˜ì

ğŸ”–íŒŒì•…í•´ì•¼í•  ìˆ«ì

1. ê²°ì†ì¹˜ì˜ ê°œìˆ˜
2. ì „ì²´ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ìˆ«ìê°

### í†µê³„ëŸ‰, ê²°ì¸¡ì¹˜ í™•ì¸

```py
join_data.isnull().sum()
join_data.describe()
```
![alt text](/assets/img_20240918/image-12.png)
![alt text](/assets/img_20240918/image-13.png)

â—describe()ëŠ” ìˆ«ì ë°ì´í„°ë¥¼ ì§‘ê³„í•´ì£¼ë¯€ë¡œ ê¸°ê°„ ë“±ì˜ ë°ì´í„°ëŠ” ë”°ë¡œ í™•ì¸!

```py
print(join_data["payment_date"].min())
# 2019-02-01 01:36:57
print(join_data["payment_date"].max())
# 2019-07-31 23:41:38
```

# 008.ì›”ë³„ë¡œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ ë³´ì

â—ì‹œê³„ì—´ ìƒí™©ì„ ì‚´í´ë³´ì!
ê³¼ê±° ìˆ˜ë…„ì˜ ë°ì´í„°ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ì´ í¬í•¨ë˜ì–´ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë¶„ì„í•˜ë©´ ë°ì´í„°ì˜ ì‹œê³„ì—´ ë³€í™”ë¥¼ ì˜ëª» íŒŒì•…í•  ìˆ˜ ìˆë‹¤. ì´ëŸ´ë• **ë°ì´í„° ë²”ìœ„ë¥¼ ì¤„ì—¬** ë¶„ì„í•˜ì.

```py
join_data.dtypes
```
![alt text](/assets/img_20240918/image-14.png)
```py
join_data["payment_date"] = pd.to_datetime(join_data["payment_date"])
# datetime í˜•ìœ¼ë¡œ ë³€í™˜
join_data["payment_month"] = join_data["payment_date"].dt.strftime("%Y%m")
# ì—°ì›” ë‹¨ìœ„ë¡œ ì‘ì„±
# datetimeì˜ dtë¥¼ ì‚¬ìš©í•˜ë©´ ë…„, ì›”ì˜ ì¶”ì¶œì´ ê°€ëŠ¥
join_data[["payment_date", "payment_month"]].head()
```
![alt text](/assets/img_20240918/image-15.png)

### pd.to_datetime, strptime, strftime

- pd.to_datetime: ë¬¸ìì—´ -> datetime
- dt.date:
    -  ë…„, ì›”, ì¼ ì •ë³´ë§Œ ì¶”ì¶œ
    - dt.strftime(%Y-%m-%d)ì™€ ê°™ìŒ
    - dtype: object
- dt.days: ì¼ ìˆ˜(Number of days)ë¥¼ êµ¬í•œë‹¤.
- strptime: ë¬¸ìì—´ -> datetime í˜•íƒœë¡œ ë°”ê¾¸ê¸°
- strftime: datetime -> ë¬¸ìì—´ í˜•íƒœë¡œ ë°”ê¾¸ê¸°

# 009.ì›”ë³„, ìƒí’ˆë³„ë¡œ ë°ì´í„°ë¥¼ ì§‘ê³„í•´ ë³´ì

```py
# join_data.groupby(["payment_month","item_name"]).sum()[["price","quantity"]] -> ì˜¤ë¥˜ ë°œìƒ
join_data.groupby(["payment_month","item_name"]).sum(numeric_only=True)[["price","quantity"]]
# groupbyì—ì„œ ì¶œë ¥í•˜ê³  ì‹¶ì€ ì¹¼ëŸ¼ì´ ì—¬ëŸ¬ ê°œ ìˆì„ ê²½ìš°, ë¦¬ìŠ¤íŠ¸í˜•ìœ¼ë¡œ ì§€ì •.
```
![alt text](/assets/img_20240918/image-16.png)

```py
pd.pivot_table(join_data, index = "item_name", columns = "payment_month", values = ["price", "quantity"], aggfunc="sum")
# pivot_tableì€ í–‰ê³¼ ì¹¼ëŸ¼ì„ ì§€ì •í•  ìˆ˜ ìˆìŒ
# valuesì—ëŠ” ì§‘ê³„í•˜ê³  ì‹¶ì€ ì¹¼ëŸ¼
# aggfuncì—ëŠ” ì§‘ê³„ ë°©ë²•ì„ ì§€ì •
```
![alt text](/assets/img_20240918/image-17.png)

# 010.ìƒí’ˆë³„ ë§¤ì¶œ ì¶”ì´ë¥¼ ê°€ì‹œí™”í•´ ë³´ì

```py
graph_data = pd.pivot_table(join_data, index="payment_month", columns="item_name", values="price", aggfunc="sum")
graph_data.head()
```
![alt text](/assets/img_20240918/image-18.png)

```py
import matplotlib.pyplot as plt
%matplotlib inline
plt.plot(list(graph_data.index), graph_data["PC-A"], label="PC-A")
# graph_dataë¥¼ list í˜•íƒœë¡œ ë³€í™˜í•´ì„œ ì§€ì •
plt.plot(list(graph_data.index), graph_data["PC-B"], label="PC-B")
plt.plot(list(graph_data.index), graph_data["PC-C"], label="PC-C")
plt.plot(list(graph_data.index), graph_data["PC-D"], label="PC-D")
plt.plot(list(graph_data.index), graph_data["PC-E"], label="PC-E")
plt.legend()
# ë²”ë¡€ í‘œì‹œ
```
![alt text](/assets/img_20240918/image-19.png)