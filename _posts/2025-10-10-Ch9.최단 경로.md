---
excerpt: "CHAPTER 9. μµλ‹¨ κ²½λ΅"
name: J
writer: J
categories: [μ±… μ •λ¦¬, μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”© ν…μ¤νΈλ‹¤.] # [λ©”μΈ μΉ΄ν…κ³ λ¦¬, μ„λΈ μΉ΄ν…κ³ λ¦¬]
tags:
  - []

toc: true
toc_sticky: true

date: 2025-10-10
last_modified_at: 2024-10-10

# --- μ•„λ λ¶€ν„° content
---
# 1. κ°€μ¥ λΉ λ¥Έ κΈΈ μ°ΎκΈ°
## κ°€μ¥ λΉ λ¥΄κ² λ„λ‹¬ν•λ” λ°©λ²•
- μµλ‹¨ κ²½λ΅: κ°€μ¥ μ§§μ€ κ²½λ΅λ¥Ό μ°Ύλ” μ•κ³ λ¦¬μ¦.
    - μ ν• μμ‹
        - ν• μ§€μ μ—μ„ λ‹¤λ¥Έ νΉμ • μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅λ¥Ό κµ¬ν•΄μ•Ό ν•λ” κ²½μ°
        - λ¨λ“  μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅λ¥Ό λ¨λ‘ κµ¬ν•΄μ•Ό ν•λ” κ²½μ°
    - κ·Έλν”„ μ΄μ©ν•΄ ν‘ν„
        - λ…Έλ“: κ° μ§€μ 
        - κ°„μ„ : μ§€μ  κ°„ μ—°κ²°λ λ„λ΅
    - λ€ν‘ μ•κ³ λ¦¬μ¦
        1. λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦
        2. ν”λ΅μ΄λ“ μ›μ…
        3. λ²¨λ§ ν¬λ“
    
## λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦
> β­ν‚¤ ν¬μΈνΈ<br> - μµλ‹¨ κ±°λ¦¬λ¥Ό κ°€μ§€λ” λ…Έλ“λ¥Ό ν•λ‚μ”© λ°λ³µμ μΌλ΅ μ„ νƒ -> ν•΄λ‹Ή λ…Έλ“λ¥Ό κ±°μ³ κ°€λ” κ²½λ΅ ν™•μΈ -> μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ” κ°±μ‹ 


- μ—¬λ¬ κ°μ λ…Έλ“κ°€ μμ„ λ•, νΉμ •ν• λ…Έλ“μ—μ„ μ¶λ°ν•μ—¬ λ‹¤λ¥Έ λ…Έλ“λ΅ κ°€λ” κ°κ°μ μµλ‹¨ κ²½λ΅λ¥Ό κµ¬ν•΄μ£Όλ” μ•κ³ λ¦¬μ¦.
- 'μμ κ°„μ„ 'μ΄ μ—†μ„ λ• μ •μƒ μ‘λ™.
- νΉμ§•:<br>
    1) 'κ° λ…Έλ“μ— λ€ν• ν„μ¬κΉμ§€μ μµλ‹¨ κ±°λ¦¬' μ •λ³΄λ¥Ό ν•­μƒ 1μ°¨μ› λ¦¬μ¤νΈ(μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”)μ— μ €μ¥ν•λ©° λ¦¬μ¤νΈ κ³„μ† κ°±μ‹ .
    2) λ§¤λ² ν„μ¬ μ²λ¦¬ν•κ³  μλ” λ…Έλ“λ¥Ό κΈ°μ¤€μΌλ΅ μ£Όλ³€ κ°„μ„  ν™•μΈ.
    3) 'λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ ν„μ¬ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό ν™•μΈ'ν•΄ κ·Έ λ…Έλ“μ— λ€ν•μ—¬ μ•„λμ 4λ² κ³Όμ •μ„ μν–‰ -> κ·Έλ¦¬λ””!

    ![alt text](../assets/img_20251010/image-1.png)

- κµ¬ν„ λ°©λ²•:<br>
    λ°©λ²• 1. κµ¬ν„ν•κΈ° μ‰½μ§€λ§ λλ¦¬κ² λ™μ‘ν•λ” μ½”λ“
    β­λ°©λ²• 2. κµ¬ν„ν•κΈ°μ— μ΅°κΈ λ” κΉλ‹¤λ΅­μ§€λ§ λΉ λ¥΄κ² λ™μ‘ν•λ” μ½”λ“

β­κ·Έλ¦¬λ”” μ•κ³ λ¦¬μ¦! -> λ§¤λ² 'κ°€μ¥ λΉ„μ©μ΄ μ μ€ λ…Έλ“'λ¥Ό μ„ νƒν•΄μ„ μ„μμ κ³Όμ • λ°λ³µ.

1. μ¶λ° λ…Έλ“λ¥Ό μ„¤μ •
2. μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ μ΄κΈ°ν™”
3. λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“ μ„ νƒ
4. ν•΄λ‹Ή λ…Έλ“λ¥Ό κ±°μ³ λ‹¤λ¥Έ λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ„ κ³„μ‚°ν•μ—¬ μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ κ°±μ‹ 
5. μ„ κ³Όμ •μ—μ„ 3κ³Ό 4λ²μ„ λ°λ³µ

### λ™μ‘ μ›λ¦¬

![alt text](../assets/img_20251010/image.png)

![alt text](../assets/img_20251010/image-2.png)
- μ¶λ° λ…Έλ“κΉμ§€μ κ±°λ¦¬κ°€ 0μ΄κ³ , λ‹¤λ¥Έ λ¨λ“  λ…Έλ“μ— λ€ν•΄μ„λ” κ±°λ¦¬κ°€ λ¬΄ν•μΈ κ²ƒμΌλ΅ μ΄κΈ°ν™”ν•  μ μλ‹¤.

![alt text](../assets/img_20251010/image-3.png)
- 1λ² λ…Έλ“μ—μ„ 2λ² λ…Έλ“λ΅ κ±°μ³κ° λ•, ν„μ¬ κ°’μΈ λ¬΄ν•λ³΄λ‹¤ 2κ°€ λ” μ‘κΈ° λ•λ¬Έμ— 2λ΅ κ°±μ‹ ν•λ‹¤. β†’ μµλ‹¨ κ±°λ¦¬ κ°’μ΄ 2λ΅ λ°”λ€ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.
- λ§μ°¬κ°€μ§€λ΅ 3λ², 4λ² λ…Έλ“μ— λ€ν•΄μ„ λ™μΌν• λ΅μ§μΌλ΅ κ°±μ‹ ν•λ‹¤.

![alt text](../assets/img_20251010/image-4.png)
![alt text](../assets/img_20251010/image-5.png)
![alt text](../assets/img_20251010/image-6.png)
![alt text](../assets/img_20251010/image-7.png)

=> 'λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒ'ν•λ” κ³Όμ •μ„ λ°λ³µν•λ”λ°, μ΄λ ‡κ² μ„ νƒλ λ…Έλ“λ” 'μµλ‹¨ κ±°λ¦¬'κ°€ μ™„μ „ν μ„ νƒλ λ…Έλ“μ΄λ―€λ΅, λ” μ΄μƒ μ•κ³ λ¦¬μ¦μ„ λ°λ³µν•΄λ„ μµλ‹¨ κ±°λ¦¬κ°€ μ¤„μ–΄λ“¤μ§€X<br>

β­ν• λ‹¨κ³„λ‹Ή ν•λ‚μ λ…Έλ“μ— λ€ν• μµλ‹¨ κ±°λ¦¬λ¥Ό ν™•μ‹¤ν μ°Ύλ” κ²ƒ! (κ·Έλμ„ μ‚¬μ‹¤ λ§μ§€λ§‰ λ‚¨μ€ λ…Έλ“λ” μλ™ κ³ μ •)

### λ°©λ²• 1. κ°„λ‹¨ν• λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦
- μ‹κ°„ λ³µμ΅λ„: O(V^2) 
    - V: nodeμ κ°―μ<br>
    => λ…Έλ“μ κ°μκ°€ 10000κ°λ¥Ό λ„μ–΄κ°€λ©΄ 'κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦'μ„ μ΄μ©ν•΄μ•Όν•¨<br>
    => O(v)λ²μ— κ±Έμ³μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό λ§¤λ² μ„ ν• νƒμƒ‰ / O(V)μ— κ±Έμ³ μ—°κ²°λ λ…Έλ“ λ§¤λ² ν™•μΈ

1. κ° λ…Έλ“μ— λ€ν• μµλ‹¨ κ±°λ¦¬λ¥Ό λ‹΄λ” 1μ°¨μ› λ¦¬μ¤νΈ μ„ μ–Έ
2. λ‹¨κ³„λ§λ‹¤ 'λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒ'ν•κΈ° μ„ν•΄ λ§¤ λ‹¨κ³„λ§λ‹¤ 1μ°¨μ› λ¦¬μ¤νΈμ λ¨λ“  μ›μ†λ¥Ό ν™•μΈ

π”–μ°Έκ³ : μ…λ ¥λλ” λ°μ΄ν„°μ μκ°€ λ§λ‹¤λ” κ°€μ •ν•μ— νμ΄μ¬ λ‚΄μ¥ ν•¨μμΈ input()μ„ λ” λΉ λ¥΄κ² λ™μ‘ν•λ” sys.std.realine()μΌλ΅ μΉν™.<br>
π”–μ°Έκ³ 2: λ¦¬μ¤νΈλ” (λ…Έλ“μ κ°μ + 1)μ ν¬κΈ°λ΅ ν• λ‹Ήν•μ—¬, λ…Έλ“μ λ²νΈλ¥Ό μΈλ±μ¤λ΅ ν•μ—¬ λ°”λ΅ λ¦¬μ¤νΈμ— μ ‘κ·Όν•  μ μλ„λ΅ ν–λ‹¤.

```py
import sys
input = sys.stdin.readline
INF = int(1e9) #λ¬΄ν•μ„ μλ―Έν•λ” κ°’

# λ…Έλ“μ κ°μ, κ°„μ„ μ κ°μ
n, m = map(int, input().split())
start = int(input())
graph = [[] for i in range(n+1)]
visited = [False] * (n + 1)
distance = [INF] * (n + 1)

# λ¨λ“  κ°„μ„  μ •λ³΄λ¥Ό μ…λ ¥ λ°›κΈ°
for _ in range(m):
    a, b, c = map(int, input().split())
    # a -> bλ΅ κ°€λ” λΉ„μ©μ΄ c
    graph[a].append((b,c))

# λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„, κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“μ λ²νΈλ¥Ό λ°ν™
def get_smallest_node():
    min_value = INF
    index = 0
    for i in range(1, n+1):
        if distance[i] < min_value and not visited[i]:
            min_value = distance[i]
            index = i
    return index

def dijkstra(start):
    # μ‹μ‘ λ…Έλ“μ— λ€ν•΄μ„ μ΄κΈ°ν™”
    distance[start] = 0
    visited[start] = True
    for j in graph[start]:
        distance[j[0]] = j[1]
    # μ‹μ‘ λ…Έλ“λ¥Ό μ μ™Έν• μ „μ²΄ n-1κ°μ λ…Έλ“μ— λ€ν•΄ λ°λ³µ
    for i in range(n-1):
        now = get_smallest_node()
        visited[now] = True
        # ν„μ¬ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ λ…Έλ“λ¥Ό ν™•μΈ
        for j in graph[now]:
            cost = distance[now] + j[1]
            # ν„μ¬ λ…Έλ“λ¥Ό κ±°μ³μ„ λ‹¤λ¥Έ λ…Έλ“λ΅ μ΄λ™ν•λ” κ±°λ¦¬κ°€ λ” μ§§μ„ λ•
            if cost < distance[j[0]]:
                distance[j[0]] = cost

dijkstra(start)

for i in range(1, n+1):
    if distance[i] == INF:
        print("INFINITY")
    else:
        print(distance[i])
```

### λ°©λ²• 2. κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦.
- μ‹κ°„ λ³µμ΅λ„: O(ElogV)
    - V: λ…Έλ“μ κ°μ
    - E: κ°„μ„ μ κ°μ<br>

β­μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ ν•μ μΌλ΅ μ°Ύμ§€ λ§μ<br>
β­ν„μ¬ κ°€μ¥ κ°€κΉμ΄ λ…Έλ“λ¥Ό μ €μ¥ν•κΈ° μ„ν• λ©μ μΌλ΅λ§ μ°μ„ μμ„ ν μ΄μ©
- heap μλ£ κµ¬μ΅° μ΄μ©!
    - heapμ—μ„μ νƒμƒ‰ μ‹κ°„: logN

> **π’΅ν™ μ„¤λ…**
- μ°μ„ μμ„ νλ¥Ό κµ¬ν„ν•κΈ° μ„ν•΄ μ‚¬μ©λ¨.
    - μ°μ„ μμ„ ν: μ°μ„ μμ„κ°€ κ°€μ¥ λ†’μ€ λ°μ΄ν„°λ¥Ό κ°€μ¥ λ¨Όμ € μ‚­μ 
    - λ€λ¶€λ¶„ μ°μ„ μμ„ ν λΌμ΄λΈλ¬λ¦¬ μ§€μ›.
        - python: PriorityQueue or heapq(λ” λΉ λ¦„) / μµμ† ν™μ΄ λ””ν΄νΈ(μµλ€ ν™ μ“°κ³  μ‹¶μΌλ©΄ - λ„£μ—λ‹¤κ°€ λ‚μ¤‘μ— λΉΌκΈ°)
    - μ°μ„ μμ„ κ°’μ„ ν‘ν„ν•  λ•λ” μΌλ°μ μΌλ΅ μ •μν• μλ£ν•μ λ³€μκ°€ μ΄μ©.
        - μ²« λ²μ§Έ μ›μ†λ¥Ό κΈ°μ¤€μΌλ΅ μ°μ„ μμ„ μ„¤μ •.

|μ°μ„ μμ„ ν κµ¬ν„ λ°©μ‹|μ‚½μ… μ‹κ°„|μ‚­μ  μ‹κ°„|
|---|---|---|
|λ¦¬μ¤νΈ|O(1)|O(N)|
|ν™|O(logN)|O(logN)|

![alt text](../assets/img_20251010/image-8.png)
- μ¶λ° λ…Έλ“λ¥Ό '1λ²'μ΄λΌκ³  κ°€μ •ν•λ‹¤. '1λ²' λ…Έλ“κΉμ§€μ ν„μ¬ μµλ‹¨ κ±°λ¦¬ κ°’μ„ 0μΌλ΅ μ„¤μ •ν•΄μ„ μ°μ„ μμ„ νμ— λ„£λ”λ‹¤.
- μ°μ„ μμ„ νμ— λ°μ΄ν„°λ¥Ό λ„£μ„ λ• νν” ν•νƒλ΅ λ°μ΄ν„°λ¥Ό λ¬¶λ” κ³Όμ •μ—μ„ μ²«λ²μ§Έ μ›μ†λ¥Ό κ±°λ¦¬λ΅ μ„¤μ •ν•κ² λλ©΄ μ΄ κ±°λ¦¬λ¥Ό κΈ°μ¤€μΌλ΅ ν•΄μ„ λ” κ±°λ¦¬κ°€ μ‘μ€ μ›μ†κ°€ λ¨Όμ € λ‚μ¬ μ μλ„λ΅ νκ°€ κµ¬μ„±λλ‹¤.

![alt text](../assets/img_20251010/image-9.png)
![alt text](../assets/img_20251010/image-10.png)
![alt text](../assets/img_20251010/image-11.png)
![alt text](../assets/img_20251010/image-12.png)
![alt text](../assets/img_20251010/image-13.png)
![alt text](../assets/img_20251010/image-14.png)

```py
import heapq
import sys
input = sys.stdin.readline
INF = int(1e9)

n, m = map(int, input().split())
start = int(input())
graph = [[] for i in range(n+1)]
distance = [INF] * (n+1)

for _ in range(m):
    a, b, c = map(int, input().split())
    graph[a].append((b,c))

def dijkstra(start):
    q = []
    heapq.heappush(q, (0, start))
    distance[start] = 0
    while q:
        dist, now = heapq.heappop(q)
        if distance[now] < dist:
            continue
        for i in graph[now]:
            cost = dist + i[1]
            if cost < distance[i[0]]:
                distance[i[0]] = cost
                heapq.heqppush(q, (cost, i[0]))

dijkstra(start)

for i in range(1, n+1):
    if distance[i] == INF:
        print("INFINITY")
    else:
        print(distance[i])
```

## ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦
- λ¨λ“  μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅.
- λ‹¤μµμ¤νΈλΌμ™€μ μ°¨μ΄
    - 'κ±°μ³ κ°€λ” λ…Έλ“'λ¥Ό κΈ°μ¤€μΌλ΅ μ•κ³ λ¦¬μ¦ μν–‰(λ§¤λ² λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬λ¥Ό κ°–λ” λ…Έλ“ μ°Ύμ„ ν•„μ”X)
        - ex) 1λ² λ…Έλ“μ— λ€ν•΄ ν™•μΈν•  λ•λ” 1λ² λ…Έλ“λ¥Ό μ¤‘κ°„μ— κ±°μ³ μ§€λ‚κ°€λ” λ¨λ“  κ²½μ° κ³ λ ¤!
    - 2μ°¨μ› λ¦¬μ¤νΈμ— 'μµλ‹¨ κ±°λ¦¬' μ •λ³΄ μ €μ¥(μ΄λμ„ O(N^2))
    - λ‹¤μ΄λ‚λ―Ή ν”„λ΅κ·Έλλ°!!!(Nλ² λ§νΌμ λ‹¨κ³„λ¥Ό λ°λ³µν•λ©° 'μ ν™”μ‹μ— λ§κ²' 2μ°¨μ› λ¦¬μ¤νΈλ¥Ό κ°±μ‹ ν•κΈ° λ•λ¬Έ.)
- μ‹κ°„ λ³µμ΅λ„
    - Nλ²μ λ‹¨κ³„ μν–‰ / λ‹¨κ³„λ§λ‹¤ O(N^2)μ μ—°μ‚° -> λ‚¨μ€ λ…Έλ“ n-1κ° μ¤‘ μμ„ κ³ λ ¤ν•΄ 2κ° λ½‘μΌλ‹ N^2<br>
    => μ΄μ‹κ°„ λ³µμ΅λ„: O(N^3)

> μ ν™”μ‹: Dab = min(Dab, Dak + Dkb)

![alt text](../assets/img_20251010/image-15.png)
![alt text](../assets/img_20251010/image-16.png)
![alt text](../assets/img_20251010/image-17.png)
![alt text](../assets/img_20251010/image-18.png)
![alt text](../assets/img_20251010/image-19.png)

```py
INF = int(1e9)

n = int(input())
m = int(input())
graph = [[INF] * (n+1) for _ in range(n+1)]

for a in range(1, n+1):
    for b in range(1, n+1):
        if a==b:
            graph[a][b] = 0

for _ in range(m):
    a, b, c = map(int, input().split())
    graph[a][b] = c

for k in range(1, n+1):
    for a in range(1, n+1):
        for b in range(1, n+1):
            graph[a][b] = min(graph[a][b], graph[a][k] + graph[k][b])

for a in range(1, n+1):
    for b in range(1, n+1):
        if graph[a][b] == INF:
            print("INFINITY", end = " ")
        else:
            print(graph[a][b], end = " ")
    print()
```