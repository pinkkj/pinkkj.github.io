---
# Header
title: "4.ë‹¤ì–‘í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜"
excerpt: "ë‹¤ì–‘í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜"
name: J
writer: J
categories: [ë°©í•™ ML ì„¸ì…˜, í˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹] # [ë©”ì¸ ì¹´í…Œê³ ë¦¬, ì„œë¸Œ ì¹´í…Œê³ ë¦¬]
tags:
  - [Khuda, ML, data]

toc: true
toc_sticky: true

date: 2024-08-13
last_modified_at: 2024-08-13

# --- ì•„ë˜ ë¶€í„° content
---

# 4.1 ë¡œì§€ìŠ¤í‹± íšŒê·€

### K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ë¡œ í´ë˜ìŠ¤ í™•ë¥  ê³„ì‚°

- ìƒì„  ì¢…ë¥˜: 7ì¢…ë¥˜
- íŠ¹ì„±: ê¸¸ì´, ë†’ì´, ë‘ê»˜, ëŒ€ê°ì„  ê¸¸ì´, ë¬´ê²Œ

![alt text](/assets/img_20240814/image.png)

> ë°ì´í„° ì¤€ë¹„í•˜ê¸°

ğŸ”– ë°ì´í„° ì¤€ë¹„
```py
import pandas as pd
fish = pd.read_csv('https://bit.ly/fish.csv')
fish.head()
```

![alt text](/assets/img_20240814/image-1.png)

```py
# ì–´ë–¤ ì¢…ë¥˜ì˜ ìƒì„ ì´ ìˆëŠ”ì§€ ì•Œì•„ë³´ì!
print(pd.unique(fish['Species']))
# ['Bream' 'Roach' 'Whitefish' 'Parkki' 'Perch' 'Pike' 'Smelt']
```

ğŸ”– trainê³¼ target

- targetì€ Species ì—´
- ì…ë ¥ ë°ì´í„°ëŠ” ë‚˜ë¨¸ì§€ 5ê°œì˜ ì—´

```py
fish_input = fish[['Weight','Length','Diagonal','Height','Width']].to_numpy()
print(fish_input[:5])
```
![alt text](/assets/img_20240814/image-2.png)

```py
fish_target = fish['Species'].to_numpy()
```

ğŸ”– í›ˆë ¥ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸

```py
from sklearn.model_selection import train_test_split
train_input, test_input, train_target, test_target = train_test_split(fish_input, fish_target, random_state = 42)
```

ğŸ”– í‘œì¤€í™” ì „ì²˜ë¦¬

```py
from sklearn.preprocessing import StandardScaler
ss = StandardScaler()
ss.fit(train_input)
train_scaled = ss.transform(train_input)
test_scaled = ss.transform(test_input)
```

> K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°ì˜ í™•ë¥  ì˜ˆì¸¡

```py
from sklearn.neighbors import KNeighborsClassifier
kn = KNeighborsClassifier(n_neighbors = 3)
kn.fit(train_scaled, train_target)
print(kn.score(train_scaled, train_target))
print(kn.score(test_scaled, test_target))
# 0.8907563025210085
# 0.85
```

> ë‹¤ì¤‘ ë¶„ë¥˜ by K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ê¸°

- ë‹¤ì¤‘ ë¶„ë¥˜: íƒ€ê¹ƒ ë°ì´í„°ì— 2ê°œ ì´ìƒì˜ í´ë˜ìŠ¤ê°€ í¬í•¨ëœ ë¬¸ì œ
- predict_probe(): í´ë˜ìŠ¤ë³„ í™•ë¥ ê°’ ë°˜í™˜
- round(): ì†Œìˆ˜ì  ì²«ì§¸ ìë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼
    - decimals(ë§¤ê°œë³€ìˆ˜): ìœ ì§€í•  ì†Œìˆ˜ì  ì•„ë˜ ìë¦¿ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

```py
import numpy as np
# íƒ€ê¹ƒê°’ì˜ ìˆœì„œëŠ” ë¬¸ìì¼ ê²½ìš° ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ë§¤ê²¨ì§.
print(kn.classes)
# ['Bream' 'Parkki' 'Perch' 'Pike' 'Roach' 'Smelt' 'Whitefish']
proba = kn.predict_proba(test_scaled[:5])
print(np.round(proba, decimals=4))
# ì†Œìˆ˜ì  ë„¤ ë²ˆì§¸ ìë¦¬ê¹Œì§€ í‘œê¸°.
```

![alt text](/assets/img_20240814/image-3.png)

ë„¤ ë²ˆì§¸ ìƒ˜í”Œì˜ ìµœê·¼ì ‘ ì´ì›ƒì˜ í´ë˜ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì.

```py
distances, indexes = kn.kneighbors(test_scaled[3:4])
# kneighbors() ë©”ì„œë“œì˜ ì…ë ¥ì€ 2ì°¨ì› ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë„˜íŒŒì´ ë°°ì—´ì˜ ìŠ¬ë¼ì´ì‹± ì—°ì‚°ìë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ìŠ¬ë¼ì´ì‹± ì—°ì‚°ìëŠ” í•˜ë‚˜ì˜ ìƒ˜í”Œë§Œ ì„ íƒí•´ë„ í•­ìƒ 2ì°¨ì› ë°°ì—´ì´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.
print(train_target[indexes])
# [['Roach' 'Perch' 'Perch']]
```
â—3ê°œì˜ ìµœê·¼ì ‘ ì´ì›ƒì„ ì‚¬ìš©í•˜ê¸°ì— í™•ë¥ ì€ 0/3, 1/3, 2/3, 3/3ì´ ì „ë¶€ì´ë‹¤!

### ë¡œì§€ìŠ¤í‹± íšŒê·€

- ë¡œì§€ìŠ¤í‹± íšŒê·€: ë¶„ë¥˜ ëª¨ë¸.
    - ì„ í˜• ë°©ì •ì‹ì„ í•™ìŠµí•œë‹¤.<br>
        z = a x (Weight) + b x (Length) + c x (Diagonal) + d x (Height) + e x (Width) + f
    - a, b, c, d, eëŠ” ê°€ì¤‘ì¹˜ or ê³„ìˆ˜
    - **ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜**(**ë¡œì§€ìŠ¤í‹± í•¨ìˆ˜**)ë¥¼ ì´ìš©í•˜ë©´ zê°€ ì•„ì£¼ í° ìŒìˆ˜ì¼ ë•Œ 0, ì•„ì£¼ í° ì–‘ìˆ˜ì¼ ë•Œ 1ì´ ë˜ë„ë¡ ë°”ê¿€ ìˆ˜ ìˆë‹¤.

![alt text](/assets/img_20240814/image-4.png)

> ë„˜íŒŒì´ë¡œ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°

```py
import numpy as np
import matplotlib.pyplot as plt
z = np.arange(-5, 5, 0.1)
phi = 1 / (1 + np.exp(-z))
plt.plot(z, phi)
plt.show()
```
![alt text](/assets/img_20240814/image-5.png)

> ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì´ì§„ ë¶„ë¥˜ ìˆ˜í–‰í•˜ê¸°

-  0.5ë³´ë‹¤ í¼: ì–‘ì„± í´ë˜ìŠ¤
- 0.5 ë³´ë‹¤ ì‘ìŒ: ìŒì„± í´ë˜ìŠ¤
- 0.5: ë¼ì´ë¸ŒëŸ¬ë¦¬ë§ˆë‹¤ ë‹¤ë¥´ë‹¤. ì‚¬ì´í‚·ëŸ°ì€ ìŒì„± í´ë˜ìŠ¤ë¡œ íŒë‹¨.
<br><br>
- ë¶ˆë¦¬ì–¸ ì¸ë±ì‹±: ë„˜íŒŒì´ ë°°ì—´ì€ True, False ê°’ì„ ì „ë‹¬í•˜ì—¬ í–‰ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.

```py
char_arr = np.array(['A', 'B', 'C', 'D', 'E'])
print(char_arr[[True, False, True, False, False]])
# ['A' 'C']
```

ğŸ”– ë„ë¯¸ì™€ ë¹™ì–´ì˜ í–‰ë§Œ ê³¨ë¼ë³´ì!

```py
bream_smelt_indexes = (train_target == 'Bream') | (train_target == 'Smelt')
# train_target == 'Bream'ì—ì„œëŠ” train_target ë°°ì—´ì—ì„œ 'Bream'ì¸ ê²ƒì€ Trueì´ê³  ê·¸ ì™¸ëŠ” ëª¨ë‘ Falseì¸ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤.
# ìœ„ì˜ ì½”ë“œë¥¼ ìˆ˜í–‰í•˜ë©´ or ì—°ì‚°ìì— ì˜í•´ ë„ë¯¸ì™€ ë¹™ì–´ëŠ” trueê°€ ë˜ê³  ë‚˜ë¨¸ì§€ëŠ” falseê°€ ëœë‹¤.
train_bream_smelt = train_scaled[bream_smelt_indexes]
target_bream_smelt = train_target[bream_smelt_indexes]
```

ğŸ”– ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ í›ˆë ¨

```py
from sklearn.linear_model import LogisticRegression
lr = LogisticRegression()
lr.fit(train_bream_smelt, target_bream_smelt)
print(lr.predict(train_bream_smelt[:5]))
# ['Bream' 'Smelt' 'Bream' 'Bream' 'Bream']
print(lr.predict_proba(train_bream_smelt[:5]))
# ì™¼ìª½(ë„ë¯¸): ìŒì„± / ì˜¤ë¥¸ìª½(ë¹™ì–´): ì–‘ì„±
```
![alt text](/assets/img_20240814/image-6.png)

ğŸ”– ë¡œì§€ìŠ¤í‹± íšŒê·€ê°€ í•™ìŠµí•œ ê³„ìˆ˜ í™•ì¸

```py
print(lr.coef_, lr.intercept_)
# [[-0.4037798  -0.57620209 -0.66280298 -1.01290277 -0.73168947]] [-2.16155132]
```

ë”°ë¼ì„œ<br>
z = -0.404 x (weight) - 0.576 x (Length) - 0.663 x (Diagonal) - 1.013 x (Height) - 0.732 x (Width) - 2.161

ğŸ”– z ê°’ ê³„ì‚°í•´ë³´ê¸°

```py
decisions = lr.decision_function(train_bream_smelt[:5])
# z ê°’ ì¶œë ¥
print(decisions)
# [-6.02927744  3.57123907 -5.26568906 -4.24321775 -6.0607117 ]

from scipy.special import expit
# expit()ëŠ” ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜
print(expit(decisions))
# [0.00240145 0.97264817 0.00513928 0.01415798 0.00232731]
# predict_proba() ë©”ì„œë“œ ì¶œë ¥ì˜ ë‘ ë²ˆì§¸ ì—´ì˜ ê°’ê³¼ ë™ì¼í•©ë‹ˆë‹¤. ë”°ë¼ì„œ decision_function()ëŠ” ì–‘ì„± í´ë˜ìŠ¤ì— ëŒ€í•œ z ê°’ì„ ë°˜í™˜.
```

> ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ë‹¤ì¤‘ ë¶„ë¥˜ ìˆ˜í–‰í•˜ê¸°

ğŸ”– LogisticRegression í´ë˜ìŠ¤ë¡œ ë‹¤ì¤‘ ë¶„ë¥˜ ëª¨ë¸ í›ˆë ¨

```py
lr = LogisticRegression(C=20, max_iter=1000)
lr.fit(train_scaled, train_target)
print(lr.score(train_scaled, train_target))
print(lr.score(test_scaled, test_target))
# 0.9327731092436975
# 0.925
```
- max_iter = ë°˜ë³µ íšŸìˆ˜ ì§€ì •
- C: LogisticRegressionì—ì„œ ê·œì œë¥¼ ì œì–´
    - LogisticRegressionì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¦¿ì§€ íšŒê·€ì™€ ê°™ì´ ê³„ìˆ˜ì˜ ì œê³±ì„ ê·œì œí•œë‹¤.(L2 ê·œì œ)
    - CëŠ” alphaì™€ ë°˜ëŒ€ë¡œ ì‘ì„ìˆ˜ë¡ ê·œì œê°€ ì»¤ì§„ë‹¤.

```py
print(lr.predict(test_scaled[:5]))
# ['Perch' 'Smelt' 'Pike' 'Roach' 'Perch']
proba = lr.predict_proba(test_scaled[:5])
print(np.round(proba, decimals=3))
```
![alt text](/assets/img_20240814/image-7.png)

ğŸ”– ë‹¤ì¤‘ ë¶„ë¥˜ì¼ ê²½ìš° ì„ í˜• ë°©ì •ì‹

```py
print(lr.coef_.shape, lr.intercept_.shape)
# (7, 5) (7,)
```
- coefì™€ interceptëŠ” ì—´ì´ 7ê°œ => í´ë˜ìŠ¤ë§ˆë‹¤ zê°’ì„ 7ê°œ ê³„ì‚°!
- ì´ 7ê°œì˜ zê°’ì„ **ì†Œí”„íŠ¸ë§¥ìŠ¤** í•¨ìˆ˜ë¥¼ ì´ìš©í•´ í™•ë¥ ë¡œ ë³€í™˜
    - ì†Œí”„íŠ¸ë§¥ìŠ¤: ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ëŠ” í•˜ë‚˜ì˜ ì„ í˜• ë°©ì •ì‹ì˜ ì¶œë ¥ê°’ì„ 0~1 ì‚¬ì´ë¡œ ì••ì¶•. ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ ê°œì˜ ì„ í˜• ë°©ì •ì‹ì˜ ì¶œë ¥ê°’ì„ 0~1 ì‚¬ì´ë¡œ ì••ì¶•í•˜ê³  ì „ì²´ í•©ì´ 1ì´ ë˜ë„ë¡ ë§Œë“ ë‹¤.
    - ì§€ìˆ˜ í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ê¸° ë•Œë¬¸ì— **ì •ê·œí™”ëœ ì§€ìˆ˜ í•¨ìˆ˜**ë¼ê³  í•œë‹¤.


ğŸ”– ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜

- ë¨¼ì € 7ê°œì˜ zê°’ì„ ì‚¬ìš©í•´ ì§€ìˆ˜í•¨ìˆ˜ë¥¼ ê³„ì‚°í•´ ëª¨ë‘ ë”í•œë‹¤.

![alt text](/assets/img_20240814/image-8.png)

- ê° ì§€ìˆ˜í•¨ìˆ˜ë¥¼ e_sumìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì¤€ë‹¤.

![alt text](/assets/img_20240814/image-9.png)

```py
# z1~z7 ê¹Œì§€ì˜ ê°’ êµ¬í•˜ê¸°
decision = lr.decision_function(test_scaled[:5])
print(np.round(decision, decimals=2))
```
![alt text](/assets/img_20240814/image-10.png)

```py
# ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ ì´ìš©
from scipy.special import softmax
proba = softmax(decision, axis = 1)
# axis = 1ì€ ê³„ì‚°í•  ì¶•ì„ ì •í•˜ëŠ” ê²ƒì´ë‹¤. 1ì€ ê° í–‰, ì¦‰ ê° ìƒ˜í”Œì— ëŒ€í•´ ì†Œí”„íŠ¸ë§¥ìŠ¤ë¥¼ ê³„ì‚°í•œë‹¤. ë§Œì•½ axis ë§¤ê°œë³€ìˆ˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ë°°ì—´ ì „ì²´ì— ëŒ€í•´ ì†Œí”„íŠ¸ë§¥ìŠ¤ë¥¼ ê³„ì‚°í•œë‹¤.
print(np.round(proba, decimals=3))
```
![alt text](/assets/img_20240814/image-11.png)

### ì •ë¦¬

> í‚¤ì›Œë“œ

- ë¡œì§€ìŠ¤í‹± íšŒê·€: ì„ í˜• ë°©ì •ì‹ì„ ì´ìš©í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜. ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë‚˜ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë˜ìŠ¤ í™•ë¥ ì„ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.
- ë‹¤ì¤‘ ë¶„ë¥˜: íƒ€ê¹ƒ í´ë˜ìŠ¤ê°€ 2ê°œ ì´ìƒì¸ ë¶„ë¥˜ ë¬¸ì œ. ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ í´ë˜ìŠ¤ ì˜ˆì¸¡
- ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜: ì„ í˜• ë°©ì •ì‹ì˜ ì¶œë ¥ì„ 0ê³¼ 1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ì••ì¶•í•˜ë©° ì´ì§„ ë¶„ë¥˜ë¥¼ ìœ„í•´ ì´ìš©í•œë‹¤.
- ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜: ë‹¤ì¤‘ ë¶„ë¥˜ì—ì„œ ì—¬ëŸ¬ ì„ í˜• ë°©ì •ì‹ì˜ ì¶œë ¥ ê²°ê³¼ë¥¼ ì •ê·œí™”í•˜ì—¬ í•©ì´ 1ì´ ë˜ë„ë¡ í•œë‹¤.

> í•µì‹¬ íŒ¨í‚¤ì§€ì™€ í•¨ìˆ˜

- LogisticRegression   
    - solver: 'lbfgs', 'sag(í™•ë¥ ì  í‰ê·  ê²½ì‚¬ í•˜ê°•ë²•)'
    - penalty: L2 or L1 ì„ íƒ(ê¸°ë³¸ì€ 'l2')
    - C: ê·œì œì˜ ê°•ë„ ì œì–´
- predict_proba(): ì˜ˆì¸¡ í™•ë¥ ì„ ë°˜í™˜.
    - ì´ì§„ ë¶„ë¥˜: ìƒ˜í”Œë§ˆë‹¤ ìŒì„± í´ë˜ìŠ¤ì™€ ì–‘ì„± í´ë˜ìŠ¤ì— ëŒ€í•œ í™•ë¥  ë°˜í™˜.
    - ë‹¤ì¤‘ ë¶„ë¥˜: ìƒ˜í”Œë§ˆë‹¤ ëª¨ë“  í´ë˜ìŠ¤ì— ëŒ€í•œ í™•ë¥  ë°˜í™˜.
- decision_function(): ëª¨ë¸ì´ í•™ìŠµí•œ ì„ í˜• ë°©ì •ì‹ì˜ ì¶œë ¥ì„ ë°˜í™˜.
    - ì´ì§„ ë¶„ë¥˜: ì–‘ì„± í´ë˜ìŠ¤ì˜ í™•ë¥ ì´ ë°˜í™˜ëœë‹¤. ì´ ê°’ì´ 0ë³´ë‹¤ í¬ë©´ ì–‘ì„±, ì‘ê±°ë‚˜ ê°™ìœ¼ë©´ ìŒì„± í´ë˜ìŠ¤ë¡œ ì˜ˆì¸¡.
    - ë‹¤ì¤‘ ë¶„ë¥˜: ê° í´ë˜ìŠ¤ë§ˆë‹¤ ì„ í˜• ë°©ì •ì‹ì„ ê³„ì‚°.

# 4.2 í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•

### ì ì§„ì ì¸ í•™ìŠµ

- ì ì§„ì  í•™ìŠµ: ì´ì „ì— í›ˆë ¨í•œ ëª¨ë¸ì„ ë²„ë¦¬ì§€ ì•Šê³  ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•´ì„œë§Œ ì¡°ê¸ˆì”© ë” í›ˆë ¨í•˜ë„ë¡ í•˜ëŠ” í•™ìŠµ ë°©ë²•.
    - **í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•**

> í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•
 
- ê²½ì‚¬ í•˜ê°•ë²•: ê°€ì¥ ê°€íŒŒë¥¸ ê²½ì‚¬ë¥¼ ë”°ë¼ ì›í•˜ëŠ” ì§€ì ì— ë„ë‹¬í•˜ëŠ” ê²ƒì´ ëª©í‘œ. í•˜ì§€ë§Œ ì´ë•Œ ì ë‹¹íˆ **ì¡°ê¸ˆì”©** ë‚´ë ¤ì™€ì•¼ í•œë‹¤.
- í™•ë¥ ì : ê°€ì¥ ê°€íŒŒë¥¸ ê¸¸ì„ ì°¾ëŠ” ë°©ë²•. í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•´ ëª¨ë¸ì„ í›ˆë ¨í•˜ê¸° ë•Œë¬¸ì— ê²½ì‚¬ í•˜ê°•ë²•ë„ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì¥ ê°€íŒŒë¥¸ ê¸¸ì„ ì°¾ëŠ”ë‹¤. ì´ë•Œ ì „ì²´ ìƒ˜í”Œì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë”± í•˜ë‚˜ì˜ ìƒ˜í”Œì„ í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ëœë¤í•˜ê²Œ ê³¨ë¼ ê°€ì¥ ê°€íŒŒë¥¸ ê¸¸ì„ ì°¾ëŠ”ë‹¤. <br>

    => í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ëœë¤í•˜ê²Œ í•˜ë‚˜ì˜ ìƒ˜í”Œì„ ì„ íƒí•˜ì—¬ ê°€íŒŒë¥¸ ê²½ì‚¬ë¥¼ ì¡°ê¸ˆ ë‚´ë ¤ê°‘ë‹ˆë‹¤. ê·¸ë‹¤ìŒ í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ëœë¤í•˜ê²Œ ë˜ ë‹¤ë¥¸ ìƒ˜í”Œì„ í•˜ë‚˜ ì„ íƒí•˜ì—¬ ê²½ì‚¬ë¥¼ ì¡°ê¸ˆ ë‚´ë ¤ê°‘ë‹ˆë‹¤. ì „ì²´ ìƒ˜í”Œì„ ì´ìš©í•  ë•Œê¹Œì§€ ê³„ì†í•©ë‹ˆë‹¤.<br>
    => ë§Œì•½ ë‹¤ ë‚´ë ¤ì˜¤ì§€ ëª»í–ˆë‹¤ë©´? ë‹¤ì‹œ ì²˜ìŒë¶€í„°!
- ì—í¬í¬: í›ˆë ¨ ì„¸íŠ¸ë¥¼ í•œ ë²ˆ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” ê³¼ì •.
- ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•: 1ê°œì˜ ìƒ˜í”Œ ë§ê³  ì—¬ëŸ¬ ê°œì˜ ìƒ˜í”Œì„ ì‚¬ìš©í•´ ê²½ì‚¬ í•˜ê°•ë²•ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹.
- ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•: í•œ ë²ˆ ê²½ì‚¬ë¡œë¥¼ ë”°ë¼ ì´ë™í•˜ê¸° ìœ„í•´ ì „ì²´ ìƒ˜í”Œì„ ì´ìš©.(ì»´í“¨í„° ìì›ì´ ë§ì´ ì´ìš©ë¨.)

![alt text](/assets/img_20240814/image-12.png)

ğŸ”– í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ê³¼ ì‹ ê²½ë§ ì•Œê³ ë¦¬ì¦˜
- ì‹ ê²½ë§ ì•Œê³ ë¦¬ì¦˜
    - **í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(or ë¯¸ë‹ˆìºì¹˜ ê²½ì‚¬ í•˜ê°•ë²•)ì„ ê¼­ ì´ìš©.**
    - ë§ì€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— í•œ ë²ˆì— ëª¨ë“  ë°ì´í„°ë¥¼ ì´ìš©í•˜ê¸° ì–´ë ¤ì›€.
    - ëª¨ë¸ì´ ë³µì¡í•´ ìˆ˜í•™ì  ë°©ë²•ìœ¼ë¡œ í•´ë‹µì„ ì–»ê¸° ì–´ë ¤ì›€.

> ì†ì‹¤ í•¨ìˆ˜

- ì†ì‹¤ í•¨ìˆ˜: ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì´ ì–¼ë§ˆë‚˜ ì—‰í„°ë¦¬ì¸ì§€ ì¸¡ì •í•˜ëŠ” ê¸°ì¤€(ë¹„ìš© í•¨ìˆ˜ì™€ ì—„ê²©íˆ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì„ì–´ì„œ ì´ìš©)
    - ì†ì‹¤ í•¨ìˆ˜ëŠ” ë¯¸ë¶„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤!

    ![alt text](/assets/img_20240814/image-13.png)

> ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜(ì´ì§„ í¬ë¡œìŠ¤ì—”íŠ¸ë¡œí”¼ ì†ì‹¤ í•¨ìˆ˜)

![alt text](/assets/img_20240814/image-14.png)
![alt text](/assets/img_20240814/image-15.png)

- ì˜ˆì¸¡ í™•ë¥ ê³¼ í´ë˜ìŠ¤ì˜ íƒ€ê¹ƒì„ ê³±í•œ ê°’ì— ìŒìˆ˜ë¥¼ ì·¨í•œê²ƒì´ ì†ì‹¤ í•¨ìˆ˜ì˜ ê°’ì´ë‹¤.
- íƒ€ê¹ƒì´ ìŒì„± í´ë˜ìŠ¤ 0ì¼ë•ŒëŠ” ì˜ˆì¸¡ í™•ë¥ ì„ 1ì—ì„œ ë¹¼ì„œ ì–‘ì„± í´ë˜ìŠ¤ë¡œ ì˜ˆì¸¡í•  í™•ë¥ ë¡œ ë°”ê¾¸ê³  1(ì–‘ì„± í´ë˜ìŠ¤)ì„ ê³±í•œë‹¤.
- ì˜ˆì¸¡ í™•ë¥ ì— ë¡œê·¸ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ë©´ ë” ì¢‹ë‹¤. 0ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ì•„ì£¼ í° ìŒìˆ˜ê°€ ë˜ê¸°ì— ì†ì‹¤ì„ ì•„ì£¼ í¬ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.<br>
    => ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì´ ë§Œë“¤ì–´ì§„ë‹¤.

![alt text](/assets/img_20240814/image-16.png)

ğŸ”– ë‹¤ì¤‘ ë¶„ë¥˜ì˜ ì†ì‹¤í•¨ìˆ˜

- í¬ë¡œìŠ¤ì—”íŠ¸ë¡œí”¼ ì†ì‹¤ í•¨ìˆ˜

ğŸ”– íšŒê·€ì˜ ì†ì‹¤í•¨ìˆ˜

- í‰ê·  ì ˆëŒ“ê°’ ì˜¤ì¶”(íƒ€ê¹ƒì—ì„œ ì˜ˆì¸¡ì„ ëº€ ì ˆëŒ“ê°’ì„ ëª¨ë“  ìƒ˜í”Œì— í‰ê· í•œ ê°’)
- í‰ê·  ì œê³± ì˜¤ì°¨(íƒ€ê¹ƒì—ì„œ ì˜ˆì¸¡ì„ ëº€ ê°’ì„ ì œê³±í•œ ë‹¤ìŒ ëª¨ë“  ìƒ˜í”Œì— ëŒ€í•´ í‰ê· í•œ ê°’)

### SGDClassifier

```py
# ë°ì´í„° ì¤€ë¹„
import pandas as pd
fish = pd.read_csv('https://bit.ly/fish_csv')
fish_input = fish[['Weight', 'Length', 'Diagonal', 'Height', 'Width']].to_numpy()
fish_target = fish['Species'].to_numpy()

# í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ê¸°
from sklearn.model_selection import train_test_split
train_input, test_input, train_target, test_target = train_test_split(fish_input, fish_target, random_state = 42)

# í‘œì¤€í™” ì „ì²˜ê¸°
from sklearn.preprocessing import StandardScaler
ss = StandardScaler()
ss.fit(train_input)
train_scaled = ss.transform(train_input)
test_scaled = ss.transform(test_input)

# í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²• ì œê³µí•˜ëŠ” ëŒ€í‘œì ì¸ í´ë˜ìŠ¤
from sklearn.linear_model import SGDClassifier

# 2ê°œì˜ ë§¤ê°œë³€ìˆ˜
# lossëŠ” ì†ì‹¤ í•¨ìˆ˜ì˜ ì¢…ë¥˜ ì§€ì • ('log' - ë¡œì§€ìŠ¤í‹± ì†ì‹¤ í•¨ìˆ˜)
# max_iterì€ ìˆ˜í–‰í•  ì—í¬í¬ íšŸìˆ˜
sc = SGDClassifier(loss = 'log_loss', max_iter = 10, random_state=42)
sc.fit(train_scaled, train_target)
# ì •í™•ë„ ì¶œë ¥
print(sc.score(train_scaled, train_target))
print(sc.score(test_scaled, test_target))
# 0.773109243697479
# 0.775
```

â— í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì •í™•ë„ê°€ ë‚®ë‹¤! ì—í¬í¬ ë¶€ì¡±í•œë“¯<br>
â— ConvergenceWarning: ëª¨ë¸ì´ ì¶©ë¶„íˆ ìˆ˜ë ´x max_iter ëŠ˜ë¦¬ì!

```py
# partial_fit(): ëª¨ë¸ì„ ì´ì–´ì„œ í›ˆë ¨í•  ë•Œ ì´ìš©. í˜¸ì¶œí•  ë•Œë§ˆë‹¤ 1 ì—í¬í¬ì”© ì´ì–´ì„œ í›ˆë ¨í•  ìˆ˜ ìˆìŒ.
sc.partial_fit(train_scaled, train_target)
print(sc.score(train_scaled, train_target))
print(sc.score(test_scaled, test_target))
# 0.8151260504201681
# 0.85
```

ì•„ì§ ì ìˆ˜ê°€ ë‚®ì§€ë§Œ ì—í¬í¬ë¥¼ í•œ ë²ˆ ë” ì‹¤í–‰í•˜ë‹ˆ ì •í™•ë„ê°€ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ì—í¬í¬ì—ì„œ ë” í›ˆë ¨í•  í•„ìš”ê°€ ìˆì–´ ë³´ì´ë„¤ìš”. ë¬´ì‘ì • ë°˜ë³µí•  ìˆ˜ëŠ” ì—†ìœ¼ë‹ˆ ì–´ë–¤ ê¸°ì¤€ì´ í•„ìš”í•˜ê² êµ°ìš”.

### ì—í¬í¬ì™€ ê³¼ëŒ€/ê³¼ì†Œ ì í•©

- ì ì€ ì—í¬í¬ íšŸìˆ˜ -> ê³¼ì†Œ ì í•©
- ë„ˆë¬´ ë§ì€ ì—í¬í¬ íšŸìˆ˜ -> ê³¼ëŒ€ ì í•©

![alt text](/assets/img_20240814/image-17.png)

- ì¡°ê¸° ì¢…ë£Œ: ê³¼ëŒ€ ì í•©ì´ ì‹œì‘í•˜ê¸° ì „ì— í›ˆë ¨ì„ ë©ˆì¶”ëŠ” ê²ƒ(í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì ìˆ˜ê°€ ê°ì†Œí•˜ê¸° ì‹œì‘í•˜ëŠ” ì‹œì ì´ ê³¼ëŒ€ì í•©)

```py
import numpy as np
sc = SGDClassifier(loss='log_loss', random_state=42)
train_score = [] # í›ˆë ¨ ì„¸íŠ¸ ì ìˆ˜
test_score = [] # í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì ìˆ˜

# partial_fit() ë©”ì„œë“œë§Œ ì‚¬ìš©í•˜ë ¤ë©´ í›ˆë ¨ ì„¸íŠ¸ì— ìˆëŠ” ì „ì²´ í´ë˜ìŠ¤ì˜ ë ˆì´ë¸”ì„ partial_fit() ë©”ì„œë“œì— ì „ë‹¬í•´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.
classes = np.unique(train_target) 

# ë°˜ë³µë§ˆë‹¤ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì ìˆ˜ ê³„ì‚°
# _ëŠ” ë‚˜ì¤‘ì— ì‚¬ìš©í•˜ì§€ ì•Šê³  ë²„ë¦¬ëŠ” ê°’ì„ ë„£ì–´ë‘ëŠ” ìš©ë„
for _ in range(0, 300):
    sc.partial_fit(train_scaled, train_target, classes=classes)
    train_score.append(sc.score(train_scaled, train_target))
    test_score.append(sc.score(test_scaled, test_target))

# ì ìˆ˜ ê·¸ë˜í”„
import matplotlib.pyplot as plt
plt.plot(train_score)
plt.plot(test_score)
plt.show()
```

![alt text](/assets/img_20240814/image-18.png)
â— 100 ì „ì—ëŠ” ê³¼ì†Œì í•©, 100 í›„ì—ëŠ” í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ê²©ì°¨ê°€ ë²Œì–´ì§€ê³  ìˆìœ¼ë‹ˆ **100**ì´ ê°€ì¥ ì ì ˆ.

```py
sc = SGDClassifier(loss = 'log_loss', max_iter = 100, tol = None, random_state=42)
# SGDClassifierëŠ” ì¼ì • ì—í¬í¬ ë™ì•ˆ ì„±ëŠ¥ì´ í–¥ìƒë˜ì§€ ì•Šìœ¼ë©´ í›ˆë ¨ì„ ë©ˆì¶˜ë‹¤. tol ë§¤ê°œë³€ìˆ˜ì—ì„œ í–¥ìƒë  ìµœì†Ÿê°’ì„ ì§€ì •í•œë‹¤. Noneìœ¼ë¡œ ì§€ì •í•˜ë©´ max_iter ë§Œí¼ ë¬´ì¡°ê±´ ë°˜ë³µí•œë‹¤.
sc.fit(train_scaled, train_target)
print(sc.score(train_scaled, train_target))
print(sc.score(test_scaled, test_target))
# 0.957983193277311
# 0.925
```

> loss ë§¤ê°œë³€ìˆ˜

- loss ë§¤ê°œë³€ìˆ˜ì˜ ê¸°ë³¸ê°’ì€ **'hinge'**
    - **íŒì§€ ì†ì‹¤**ì€ ì„œí¬íŠ¸ ë²¡í„° ë¨¸ì‹ ì´ë¼ ë¶ˆë¦¬ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì˜ ì†ì‹¤ í•¨ìˆ˜

â— SGDClassifierê°€ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ì†ì‹¤ í•¨ìˆ˜ë¥¼ loss ë§¤ê°œë³€ìˆ˜ì— ì§€ì •í•˜ì—¬ ë‹¤ì–‘í•œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ì§€ì›í•œë‹¤.

ğŸ”– íŒì§€ ì†ì‹¤ ì´ìš©

```py
sc = SGDClassifier(loss='hinge', max_iter=100, tol=None, random_state=42)
sc.fit(train_scaled, train_target)
print(sc.score(train_scaled, train_target))
print(sc.score(test_scaled, test_target))
# 0.9495798319327731
# 0.925
```

### ì •ë¦¬

> í‚¤ì›Œë“œ

- í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•: í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ìƒ˜í”Œ í•˜ë‚˜ì”© êº¼ë‚´ ì†ì‹¤ í•¨ìˆ˜ì˜ ê²½ì‚¬ë¥¼ ë”°ë¼ ìµœì ì˜ ëª¨ë¸ì„ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜.
- ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•: ìƒ˜í”Œì„ ì—¬ëŸ¬ê°œ ì´ìš©.
- ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•: ì „ì²´ ìƒ˜í”Œì„ ì´ìš©.
- ì†ì‹¤ í•¨ìˆ˜: í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì´ ìµœì í™”í•  ëŒ€ìƒ.
- ì—í¬í¬: í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì—ì„œ ì „ì²´ ìƒ˜í”Œì„ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” í•œ ë²ˆ ë°˜ë³µì„ ì˜ë¯¸

> í•µì‹¬ íŒ¨í‚¤ì§€ì™€ í•¨ìˆ˜

- SGDClassifier
    - loss ë§¤ê°œë³€ìˆ˜: ì†ì‹¤ í•¨ìˆ˜ ì§€ì •
    - penalty: ê·œì œì˜ ì¢…ë¥˜ ì§€ì •.
    - max_iter: ì—í¬í¬ íšŸìˆ˜
    - tol: ë°˜ë³µì„ ë©ˆì¶œ ì¡°ê±´. n_iter_no_changeì—ì„œ ì§€ì •í•œ ì—í¬í¬ ë™ì•ˆ ì†ì‹¤ì´ tol ë§Œí¼ ì¤„ì–´ë“¤ì§€ ì•Šìœ¼ë©´ ì¤‘ë‹¨.

- SGDRegressor: íšŒê·€ ëª¨ë¸.
    - loss
