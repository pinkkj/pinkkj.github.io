---
# Header
title: "6.ë¹„ì§€ë„ í•™ìŠµ"
excerpt: "ë¹„ì§€ë„ í•™ìŠµ"
name: J
writer: J
categories: [ë°©í•™ ML ì„¸ì…˜, í˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹+ë”¥ëŸ¬ë‹] # [ë©”ì¸ ì¹´í…Œê³ ë¦¬, ì„œë¸Œ ì¹´í…Œê³ ë¦¬]
tags:
  - [Khuda, ML, data]

toc: true
toc_sticky: true

date: 2024-08-24
last_modified_at: 2024-08-24

# --- ì•„ë˜ ë¶€í„° content
---

# 6-1 êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜

### íƒ€ê¹ƒì„ ëª¨ë¥´ëŠ” ë¹„ì§€ë„ í•™ìŠµ

- ë¹„ì§€ë„ í•™ìŠµ: íƒ€ê¹ƒì´ ì—†ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜.

### ê³¼ì¼ ì‚¬ì§„ ë°ì´í„° ì¤€ë¹„í•˜ê¸°

- ì‚¬ê³¼(100ê°œ), ë°”ë‚˜ë‚˜(100ê°œ), íŒŒì¸ì• í”Œ(100ê°œ)ì„ ë‹´ê³  ìˆëŠ” í‘ë°± ì‚¬ì§„
- ë„˜íŒŒì´ ë°°ì—´ì˜ ê¸°ë³¸ ì €ì¥ í¬ë§·ì¸ npy íŒŒì¼ë¡œ ì €ì¥ë˜ì–´ ìˆìŒ.

```py
!wget https://bit.ly/fruits_300 -O fruits_300.npy
# '!' ë¬¸ìë¡œ ì‹œì‘í•˜ë©´ ì½”ë©ì€ ì´í›„ ëª…ë ¹ì„ íŒŒì´ì¬ ì½”ë“œê°€ ì•„ë‹ˆë¼ ë¦¬ëˆ…ìŠ¤ ì…¸ ëª…ë ¹ìœ¼ë¡œ ì´í•´í•œë‹¤.
# wget: ì›ê²© ì£¼ì†Œì—ì„œ ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì €ì¥.
# -O ì˜µì…˜ì—ì„œ ì €ì¥í•  íŒŒì¼ ì´ë¦„ì„ ì§€ì •

import numpy as np
import matplotlib.pyplot as plt

fruits = np.load('fruits_300.npy')
# npy íŒŒì¼ ë¡œë“œ

print(fruits.shape)
# (300, 100, 100)
# ì²«ë²ˆì§¸ ì°¨ì›: ìƒ˜í”Œì˜ ê°œìˆ˜ / ë‘ë²ˆì§¸ ì°¨ì›: ì´ë¯¸ì§€ ë†’ì´ / ì„¸ë²ˆì§¸ ì°¨ì›: ì´ë¯¸ì§€ ë„ˆë¹„ => ì´ë¯¸ì§€ í¬ê¸°ëŠ” 100 x 100
# ê° í”½ì…€ì€ ë„˜íŒŒì´ ë°°ì—´ì˜ ì›ì†Œ í•˜ë‚˜ì— ëŒ€ì‘.

print(fruits[0, 0, :])
# [  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   2   1    2   2   2   2   2   2   1   1   1   1   1   1   1   1   2   3   2   1    2   1   1   1   1   2   1   3   2   1   3   1   4   1   2   5   5   5    19 148 192 117  28   1   1   2   1   4   1   1   3   1   1   1   1   1    2   2   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 1   1   1   1   1   1   1   1   1   1]
# 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê²€ê²Œ ë‚˜íƒ€ë‚˜ê³  ë†’ì€ ê°’ì€ ë°ê²Œ í‘œì‹œëœë‹¤.

plt.imshow(fruits[0], cmap='gray')
plt.show()
# imshow(): ë„˜íŒŒì´ ë°°ì—´ë¡œ ì €ì¥ëœ ì´ë¯¸ì§€ ì‰½ê²Œ ê·¸ë¦¼.
```
![alt text](/assets/img_20240824/image.png)

â— ë³´í†µ í‘ë°± ìƒ˜í”Œ ì´ë¯¸ì§€ëŠ” ë°”íƒ•ì´ ë°ê³  ë¬¼ì²´ê°€ ì§™ì€ ìƒ‰! ê·¸ëŸ¬ë‚˜ ìœ„ ì‚¬ì§„ì€ ì‚¬ì§„ìœ¼ë¡œ ì°ì€ ì´ë¯¸ì§€ë¥¼ ë„˜íŒŒì´ ë°°ì—´ë¡œ ë³€í™˜í•  ë•Œ ë°˜ì „ì‹œí‚¨ ê²ƒ.<br>
=> why? ì»´í“¨í„°ëŠ” 255ì— ê°€ê¹Œìš´ ê³³ì— ì§‘ì¤‘í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

```py
plt.imshow(fruits[0], cmap='gray_r')
plt.show()
# gray_r: ë°˜ì „ ì‹œí‚´.
```
![alt text](/assets/img_20240824/image-1.png)

```py
fig, axs = plt.subplots(1, 2)
axs[0].imshow(fruits[100], cmap='gray_r')
axs[1].imshow(fruits[200], cmap='gray_r')
plt.show()
# ë°”ë‚˜ë‚˜, íŒŒì¸ì• í”Œ ì¶œë ¥
# subplots(): ì—¬ëŸ¬ ê°œì˜ ê·¸ë˜í”„ë¥¼ ë°°ì—´ì²˜ëŸ¼ ìŒ“ìŒ. ë‘ ë§¤ê°œë³€ìˆ˜ëŠ” ê·¸ë˜í”„ë¥¼ ìŒ“ì„ í–‰ê³¼ ì—´ì„ ì§€ì •(ìœ„ì—ì„œëŠ” 1ê°œì˜ í–‰, 2ê°œì˜ ì—´)
```
![alt text](/assets/img_20240824/image-2.png)

### í”½ì…€ê°’ ë¶„ì„í•˜ê¸°


ğŸ”– í‰ê·  ê³„ì‚°í•˜ê¸°<br>

â— ì´ ì˜ˆì‹œì—ì„œ ë„˜íŒŒì´ ë°°ì—´ì„ ë‚˜ëˆŒ ë•Œ 100 x 100 ì´ë¯¸ì§€ë¥¼ í¼ì²˜ì„œ ê¸¸ì´ê°€ 10,000ì¸ 1ì°¨ì› ë°°ì—´ë¡œ ë§Œë“¤ì! => ê³„ì‚°í•˜ê¸° í¸í•¨.

```py
apple = fruits[0:100].reshape(-1, 100*100)
pineapple = fruits[100:200].reshape(-1, 100*100)
banana = fruits[200:300].reshape(-1, 100*100)
print(apple.shape)
# ë°°ì—´ì˜ í¬ê¸°ëŠ” (100, 10000)
```

```
ğŸ’¡ axis ì¸ìˆ˜?

- axis: ë°°ì—´ì˜ 'ì¶•'ì„ ì˜ë¯¸.
    - axis = 1: ì—´ ë°©í–¥ì„ ê³„ì‚°.
    - axis = 0: í–‰ ë°©í–¥ìœ¼ë¡œ ê³„ì‚°.
```
![alt text](/assets/img_20240824/image-4.png)

```py
print(apple.mean(axis=1))
# np.mean() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ë„˜íŒŒì´ ë°°ì—´ì€ ì´ëŸ° í•¨ìˆ˜ë¥¼ ë©”ì„œë“œë¡œ ì œê³µ.
# 2ì°¨ì› ë°°ì—´ì„ 1ì°¨ì› ë°°ì—´ë¡œ ì¹˜í™˜í–ˆìœ¼ë‹ˆ axis = 1ë¡œ ì§€ì •í•˜ì—¬ í‰ê·  ê³„ì‚°.
# [ 88.3346  97.9249  87.3709  98.3703  92.8705  82.6439  94.4244  95.5999    90.681   81.6226  87.0578  95.0745  93.8416  87.017   97.5078  87.2019  88.9827 100.9158  92.7823 100.9184 104.9854  88.674   99.5643  97.2495  94.1179  92.1935  95.1671  93.3322 102.8967  94.6695  90.5285  89.0744  97.7641  97.2938 100.7564  90.5236 100.2542  85.8452  96.4615  97.1492  90.711  102.3193  87.1629  89.8751  86.7327  86.3991  95.2865  89.1709  96.8163  91.6604  96.1065  99.6829  94.9718  87.4812  89.2596  89.5268  93.799   97.3983  87.151   97.825  103.22    94.4239  83.6657  83.5159  102.8453  87.0379  91.2742 100.4848  93.8388  90.8568  97.4616  97.5022  82.446   87.1789  96.9206  90.3135  90.565   97.6538  98.0919  93.6252  87.3867  84.7073  89.1135  86.7646  88.7301  86.643   96.7323  97.2604  81.9424  87.1687  97.2066  83.4712  95.9781  91.8096  98.4086 100.7823  101.556  100.7027  91.6098  88.8976]
```

ğŸ”– íˆìŠ¤í† ê·¸ë¨ìœ¼ë¡œ ê·¸ë¦¬ê¸°

```
ğŸ’¡ íˆìŠ¤í† ê·¸ë¨ì´ë€?

- íˆìŠ¤í† ê·¸ë¨: ê°’ì´ ë°œìƒí•œ ë¹ˆë„ë¥¼ ê·¸ë˜í”„ë¡œ í‘œì‹œí•œ ê²ƒ. ë³´í†µ xì¶•ì´ ê°’ì˜ êµ¬ê°„ì´ê³ , yì¶•ì€ ë°œìƒ ë¹ˆë„ì…ë‹ˆë‹¤.
```

```py
plt.hist(np.mean(apple, axis=1), alpha=0.8)
plt.hist(np.mean(pineapple, axis=1), alpha=0.8)
plt.hist(np.mean(banana, axis=1), alpha=0.8)
plt.legend(['apple', 'pineapple','banana'])
plt.show()
# hist(): íˆìŠ¤í† ê·¸ë¨ ê·¸ë¦¬ê¸°
# alphaë¥¼ 1ë³´ë‹¤ ì‘ê²Œ í•˜ë©´ íˆ¬ëª…ë„ë¥¼ ì¤„ ìˆ˜ ìˆìŒ.
# legend(): ì–´ë–¤ ê³¼ì¼ì˜ íˆìŠ¤í† ê·¸ë¨ì¸ì§€ ë²”ë¡€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ.
```
![alt text](/assets/img_20240824/image-5.png)

- ë°”ë‚˜ë‚˜: 40ì•„ë˜ ì§‘ì¤‘ / ì‚¬ê³¼, íŒŒì¸ì• í”Œ: 90~100

â— êµ¬ë¶„ ì–´ë ¤ì›€!

ğŸ”– ìƒ˜í”Œì˜ í‰ê· ê°’x í”½ì…€ë³„ í‰ê· ê°’ ë¹„êµ!

```py
fig, axs = plt.subplots(1, 3, figsize=(20,5))
# ê·¸ë˜í”„ë¥¼ ì—¬ëŸ¬ê°œ ê·¸ë¦¬ê¸° ìœ„í•´ ì´ìš©(1 x 3 tableì„ ê·¸ë¦¬ê² ë‹¤ëŠ” ì˜ë¯¸)
axs[0].bar(range(10000), np.mean(apple, axis=0))
axs[0].bar(range(10000), np.mean(pineapple, axis=0))
axs[0].bar(range(10000), np.mean(banana, axis=0))
# í–‰ì„ ë”°ë¼ ê³„ì‚°. í”½ì…€ë³„ í‰ê· !
plt.show()
```
![alt text](/assets/img_20240824/image-6.png)

í”½ì…€ë³„ë¡œ í‰ê· ë‚¸ê²ƒì„ ê·¸ë¦¼ìœ¼ë¡œ ê·¸ë ¤ë³´ì!

```py
apple_mean = np.mean(apple, axis=0).reshape(100, 100)
pineapple_mean = np.mean(pineapple, axis=0).reshape(100, 100)
banana_mean = np.mean(banana, axis=0).reshape(100, 100)
fig, axs = plt.subplots(1, 3, figsize=(20,5))
axs[0].imshow(apple_mean, cmap='gray_r')
axs[1].imshow(pineapple_mean, cmap='gray_r')
axs[2].imshow(banana_mean, cmap='gray_r')
plt.show()
```
![alt text](/assets/img_20240824/image-7.png)

### í‰ê· ê°’ê³¼ ê°€ê¹Œìš´ ì‚¬ì§„ ê³ ë¥´ê¸°

```py
abs_diff = np.abs(fruits - apple_mean)
abs_mean = np.mean(abs_diff, axis(1,2))
# ë¨¼ì € í–‰ì„ ë”°ë¼ í‰ê· ë‚´ê³ , ì—´ì„ ë”°ë¼ í‰ê·  ë‚´ëŠ” ê²ƒ.

print(abs_mean.shape)
# (300,)

apple_index = np.argsort(abs_mean)[:100]
# np.argsort(): ì‘ì€ ê²ƒì—ì„œ í° ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•œ ë°°ì—´ì˜ ì¸ë±ìŠ¤ë¥¼ ë°˜í™˜.

fig, axs = plt.subplots(10, 10, figsize=(10,10))
for i in range(10):
    for j in range(10):
        axs[i, j].imshow(fruits[apple_index[i*10 + j]], cmap='gray_r')
        axs[i, j].axis('off')
        # axis('off'): ì¢Œí‘œì¶•ì€ ê·¸ë¦¬ì§€x
plt.show()
```
![alt text](/assets/img_20240824/image-8.png)

### êµ°ì§‘ê³¼ í´ëŸ¬ìŠ¤í„°

- êµ°ì§‘: ë¹„ìŠ·í•œ ìƒ˜í”Œë¼ë¦¬ ê·¸ë£¹ìœ¼ë¡œ ëª¨ìœ¼ëŠ” ì‘ì—….
- í´ëŸ¬ìŠ¤í„°: êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ë§Œë“  ê·¸ë£¹.

# 6-2 K-í‰ê· 

- K-í‰ê· : êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì´ í‰ê· ê°’ì„ ìë™ìœ¼ë¡œ ì°¾ì•„ì¤€ë‹¤.
- í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬(ì„¼íŠ¸ë¡œì´ë“œ): í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬ì— ìœ„ì¹˜í•œ í‰ê· ê°’.

### K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ ì†Œê°œ

ğŸ”– ì‘ë™ ë°©ì‹

1. ë¬´ì‘ìœ„ë¡œ Kê°œì˜ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì •í•¨.
2. ê° ìƒ˜í”Œì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì°¾ì•„ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ìƒ˜í”Œë¡œ ì§€ì •.
3. í´ëŸ¬ìŠ¤í„°ì— ì†í•œ ìƒ˜í”Œì˜ í‰ê· ê°’ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ë³€ê²½.
4. í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì— ë³€í™”ê°€ ì—†ì„ ë•Œê¹Œì§€ 2ë²ˆìœ¼ë¡œ ëŒì•„ê°€ ë°˜ë³µ.

![alt text](/assets/img_20240824/image-9.png)

### KMeans í´ë˜ìŠ¤

```py
!wget https://bit.ly/fruits_300 -O fruits_300.npy

import numpy as np
fruits = np.load('fruits_300.npy')
fruits_2d = fruits.reshape(-1, 100*100)
# (ìƒ˜í”Œ ê°œìˆ˜, ë„ˆë¹„, ë†’ì´) -> (ìƒ˜í”Œ ê°œìˆ˜, ë„ˆë¹„xë†’ì´)

from sklearn.cluster import KMeans
km = KMeans(n_clusters=3, random_state=42)
# n_cluster: í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ ì§€ì •

km.fit(fruits_2d)
# target_dataëŠ” í•„ìš”x

print(km.labels_)
# labels_: ê° ìƒ˜í”Œì´ ì–´ë–¤ ë ˆì´ë¸”ì— í•´ë‹¹ë˜ëŠ”ì§€ ë‚˜íƒ€ëƒ„.
# [0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 2 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 2 2 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]

print(np.unique(km.labels_, return_counts=True))
# unique: ë„˜íŒŒì´ ë°°ì—´ì—ì„œ ì¤‘ë³µëœ ê°’ì„ ì œê±°í•˜ê³ , ì¤‘ë³µë˜ì§€ ì•Šì€ ê°’ë“¤ë¡œ ì´ë£¨ì–´ì§„ ìƒˆë¡œìš´ ë°°ì—´ì„ ë°˜í™˜
# return_counts: Trueë¡œ ì§€ì •í•˜ë©´, ì¤‘ë³µë˜ì§€ ì•Šì€ ê°’ë“¤ì´ ê°ê° ëª‡ ë²ˆì”© ë“±ì¥í•˜ëŠ”ì§€ì˜ ë¹ˆë„ë¥¼ í•¨ê»˜ ë°˜í™˜í•´ì¤ë‹ˆë‹¤. 
# (array([0, 1, 2], dtype=int32), array([ 91,  98, 111]))

import matplotlib.pyplot as plt
def draw_fruits(arr, ratio=1):
    n = len(arr)  # nì€ ìƒ˜í”Œ ê°œìˆ˜
    # í•œ ì¤„ì— 10ê°œì”© ì´ë¯¸ì§€ë¥¼ ê·¸ë¦½ë‹ˆë‹¤. ìƒ˜í”Œ ê°œìˆ˜ë¥¼ 10ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì „ì²´ í–‰ ê°œìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    rows = int(np.ceil(n/10))
    # í–‰ì´ 1ê°œì´ë©´ ì—´ì˜ ê°œìˆ˜ëŠ” ìƒ˜í”Œ ê°œìˆ˜ì…ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ 10ê°œ ì…ë‹ˆë‹¤.
    # np.ceil: ë¬´ì¡°ê±´ ì˜¬ë¦¼í•˜ëŠ” í•¨ìˆ˜
    cols = n if rows < 2 else 10
    fig, axs = plt.subplots(rows, cols, figsize = (cols*ratio, rows*ratio), squeeze=False)

    for i in range(rows):
        for j in range(cols):
            if i*10 + j > n:   # n ê°œê¹Œì§€ë§Œ ê·¸ë¦½ë‹ˆë‹¤
                axs[i, j].imshow(arr[i*10 + j], cmap='gray_r')
            axs[i, j].axis('off')
    plt.show()

draw_fruits(fruits[km.labels_==0])
draw_fruits(fruits[km.labels_==1])
draw_fruits(fruits[km.labels_==2])
# ë¶ˆë¦¬ì–¸ ì¸ë±ì‹± ì´ìš©.
```
![alt text](/assets/img_20240824/image-10.png)
![alt text](/assets/img_20240824/image-11.png)
![alt text](/assets/img_20240824/image-12.png)

### í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬

ğŸ”– ì¤‘ì‹¬ êµ¬í•˜ê¸°

```py
print(km.cluster_centers_)
print(km.cluster_centers_.shape)
# [[1.01098901 1.01098901 1.01098901 ... 1.         1.         1.        ][1.10204082 1.07142857 1.10204082 ... 1.         1.         1.        ][1.         1.         1.         ... 1.         1.         1.        ]]
# (3, 10000)

draw_fruits(km.cluster_centers_.reshape(-1, 100, 100), ratio=3)
```
![alt text](/assets/img_20240824/image-13.png)

ğŸ”– transform()

- transform(): í›ˆë ¨ ë°ì´í„° ìƒ˜í”Œì—ì„œ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ê¹Œì§€ ê±°ë¦¬ë¡œ ë³€í™˜í•´ì¤Œ(StandardScaler í´ë˜ìŠ¤ì²˜ëŸ¼ íŠ¹ì„±ê°’ì„ ë³€í™˜í•˜ëŠ” ë„êµ¬ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.)

```py
print(km.transform(fruits_2d[100:101]))
# [[5267.70439881 8837.37750892 3393.8136117 ]]
# transform()ë„ 2ì°¨ì› ë°°ì—´ì„ ê¸°ëŒ€í•œë‹¤. fruits_2d[100]ìœ¼ë¡œ í•˜ë©´ (1000, )í¬ê¸°ì˜ ë°°ì—´ì´ ë˜ë¯€ë¡œ ì—ëŸ¬ ë°œìƒ!
```

ğŸ”– predict()
```py
print(km.predict(fruits_2d[100:101]))
# [2]
# ê°€ì¥ ê±°ë¦¬ê°€ ê°€ê¹Œìš´ ì„¸ ë²ˆì§¸ í´ëŸ¬ìŠ¤í„°ë¡œ ì˜ˆì¸¡ëœë‹¤.

draw_fruits(fruits[100:101])
```
![alt text](/assets/img_20240824/image-14.png)

ğŸ”– n_iter_

- n_iter_: ì•Œê³ ë¦¬ì¦˜ì´ ë°˜ë³µëœ íšŸìˆ˜(ìµœì ì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ëª‡ë²ˆë§Œì— ì°¾ì•˜ë‚˜?)

```py
print(km.n_iter_)
# 4
```

â— n_init: ë°˜ë³µ íšŸìˆ˜(ëœë¤í•˜ê²Œ ì„¼íŠ¸ë¡œì´ë“œ ì´ˆê¸°í™”)

### ìµœì ì˜ K ì°¾ê¸°

- K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì˜ ë‹¨ì  ì¤‘ í•˜ë‚˜ëŠ” í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ë¥¼ ì‚¬ì „ì— ì§€ì •í•´ì•¼ í•œë‹¤ëŠ” ê²ƒ!

ğŸ”– ì—˜ë³´ìš°

- ì—˜ë³´ìš°: í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ë¥¼ ëŠ˜ë ¤ê°€ë©´ì„œ ì´ë…€ì„œì˜ ë³€í™”ë¥¼ ê´€ì°°í•˜ì—¬ ìµœì ì˜ í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ë¥¼ ì°¾ëŠ” ë°©ë²•.
- ì´ë„ˆì…”: í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ê³¼ í´ëŸ¬ìŠ¤í„°ì— ì†í•œ ìƒ˜í”Œ ì‚¬ì´ì˜ ê±°ë¦¬(í´ëŸ¬ìŠ¤í„°ì— ì†í•œ ìƒ˜í”Œì´ ì–¼ë§ˆë‚˜ ê°€ê¹ê²Œ ëª¨ì—¬ ìˆëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” ê°’)
    - í´ëŸ¬ìŠ¤í„° ê°¯ìˆ˜ ì¦ê°€ -> ì´ë„ˆì…” ê°ì†Œ

![alt text](/assets/img_20240824/image-15.png)

```py
inertia = []
for k in range(2, 7):
    km = KMeans(n_clusters=k, random_state=42)
    km.fit(fruits_2d)
    inertia.append(km.inertia_)
    # inertia_ ì†ì„±ìœ¼ë¡œ ì´ë…€ì„œ ê°’ ì œê³µ
plt.plot(range(2,7), inertia)
plt.show()
```
![alt text](/assets/img_20240824/image-16.png)

# 6-3 ì£¼ì„±ë¶„ ë¶„ì„

### ì°¨ì›ê³¼ ì°¨ì› ì¶•ì†Œ

- ì°¨ì›: íŠ¹ì„±(ê³¼ì¼ ì‚¬ì§„ì˜ ê²½ìš° 10000ê°œì˜ í”½ì…€ì´ 10000ê°œì˜ íŠ¹ì„±)

```
ğŸ’¡ 2ì°¨ì› ë°°ì—´ê³¼ 1ì°¨ì› ë°°ì—´ì˜ ì°¨ì›ì€ ë‹¤ë¥¸ ê±´ê°€ìš”?

ë‹¤ì°¨ì› ë°°ì—´ì—ì„œ ì°¨ì›ì€ ë°°ì—´ì˜ ì¶• ê°œìˆ˜ê°€ ë©ë‹ˆë‹¤. ê°€ë ¹ 2ì°¨ì› ë°°ì—´ì¼ ë•ŒëŠ” í–‰ê³¼ ì—´ì´ ì°¨ì›ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ë°°ì—´, ì¦‰ ë²¡í„°ì¼ ê²½ìš°ì—ëŠ” ì›ì†Œì˜ ê°œìˆ˜ë¥¼ ë§í•©ë‹ˆë‹¤.
```
![alt text](/assets/img_20240824/image-17.png)

- â­ì°¨ì› ì¶•ì†Œ: ë°ì´í„°ë¥¼ ê°€ì¥ ì˜ ë‚˜íƒ€ë‚´ëŠ” ì¼ë¶€ íŠ¹ì„±ì„ ì„ íƒí•˜ì—¬ ë°ì´í„° í¬ê¸°ë¥¼ ì¤„ì´ê³  ì§€ë„ í•™ìŠµ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” ë°©ë²•.

â—ì¤„ì–´ë“  ì°¨ì›ì—ì„œ ë‹¤ì‹œ ì›ë³¸ ì°¨ì›ìœ¼ë¡œ ì†ì‹¤ì„ ìµœëŒ€í•œ ì¤„ì´ë©´ì„œ ë³µì›í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.<br>
â—ì´ë²ˆ ì ˆì—ì„œëŠ” ëŒ€í‘œ ì°¨ì› ì¶•ì†Œ ì•Œê³ ë¦¬ì¦˜ **ì£¼ì„±ë¶„ ë¶„ì„**ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

### ì£¼ì„±ë¶„ ë¶„ì„(PCA) ì†Œê°œ

- ì£¼ì„±ë¶„ ë¶„ì„: ë°ì´í„°ì— ìˆëŠ” ë¶„ì‚°(ë°ì´í„°ê°€ ë„ë¦¬ í¼ì ¸ìˆëŠ” ì •ë„)ì´ í° ë°©í–¥ì„ ì°¾ëŠ” ê²ƒ.<br>
    => ë¶„ì‚°ì´ í° ë°©í–¥ì„ ë°ì´í„°ë¡œ ì˜ í‘œí˜„í•˜ëŠ” ë²¡í„°(ì£¼ì„±ë¶„) ì°¾ê¸°!
- ì£¼ì„±ë¶„ ë²¡í„°: ì›ë³¸ ë°ì´í„°ì— ìˆëŠ” ì–´ë–¤ ë°©í–¥.
    - ì£¼ì„±ë¶„ ë²¡í„°ì˜ ì›ì†Œ ê°œìˆ˜ëŠ” ì›ë³¸ ë°ì´í„°ì…‹ì— ìˆëŠ” íŠ¹ì„± ê°œìˆ˜ì™€ ê°™ë‹¤.

ğŸ”– ì²«ë²ˆì§¸ ì£¼ì„±ë¶„

![alt text](/assets/img_20240824/image-18.png)


ì´ ì§ì„ ì´ ì›ì ì—ì„œ ì¶œë°œí•œë‹¤ë©´ ë‘ ì›ì†Œë¡œ ì´ë£¨ì–´ì§„ ë²¡í„°(ì£¼ì„±ë¶„)ë¡œ ì“¸ ìˆ˜ ìˆë‹¤.

![alt text](/assets/img_20240824/image-20.png)

ğŸ”– ë‘ë²ˆì§¸ ì£¼ì„±ë¶„

ì²«ë²ˆì§¸ ì£¼ì„±ë¶„ ë²¡í„°ì— ìˆ˜ì§ì´ê³  ë¶„ì‚°ì´ ê°€ì¥ í° ë‹¤ìŒ ë°©í–¥.

![alt text](/assets/img_20240824/image-22.png)

â—ì£¼ì„±ë¶„ì€ ì›ë³¸ íŠ¹ì„±ì˜ ê°œìˆ˜ë§Œí¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.(ì›ë³¸ íŠ¹ì„±ì˜ ê°œìˆ˜ì™€ ìƒ˜í”Œ ê°œìˆ˜ ì¤‘ ì‘ì€ ê°’ë§Œí¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.)

ğŸ”– ì£¼ì„±ë¶„ ì´ìš©í•´ ì°¨ì› ì¤„ì´ê¸°

![alt text](/assets/img_20240824/image-21.png)

ìƒ˜í”Œ ë°ì´í„° s(4,2)ë¥¼ ì£¼ì„±ë¶„ì— ì§ê°ìœ¼ë¡œ íˆ¬ì˜í•˜ë©´ 1ì°¨ì› ë°ì´í„° p(4,5)ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

â—ì£¼ì„±ë¶„ì€ ì›ë³¸ ì°¨ì›ê³¼ ê°™ê³  ì£¼ì„±ë¶„ìœ¼ë¡œ ë°”ê¾¼ ë°ì´í„°ëŠ” ì°¨ì›ì´ ì¤„ì–´ë“ ë‹¤.

### PCA í´ë˜ìŠ¤

```py
!wget https://bit.ly/fruits_300 -O fruits_300.npy
import numpy as np
fruits = np.load('fruits_300.npy')
fruits_2d = fruits.reshape(-1, 100*100)

from sklearn.decomposition import PCA
pca = PCA(n_components = 50)
# n_components: ì£¼ì„±ë¶„ì˜ ê°œìˆ˜
pca.fit(fruits_2d)

print(pca.components_.shape)
# components_: í´ë˜ìŠ¤ê°€ ì°¾ì€ ì£¼ì„±ë¶„
# (50, 10000)

draw_fruits(pca.components_.reshape(-1, 100, 100))
```
![alt text](/assets/img_20240824/image-23.png)

```py
print(fruits_2d.shape)
# (300, 10000)
fruits_pca = pca.transform(fruits_2d)
print(fruits_pca.shape)
# (300, 50)
# transform(): ì›ë³¸ ë°ì´í„°ì˜ ì°¨ì›ì„ ì¤„ì„(ì£¼ì„±ë¶„ìœ¼ë¡œ ë¶„í•´)
```

### ì›ë³¸ ë°ì´í„° ì¬êµ¬ì„±

```py
fruits_inverse = pca.inverse_transform(fruits_pca)
# inverse_transform(): ì›ë³¸ ë°ì´í„°ë¥¼ ì¬êµ¬ì„±í•˜ëŠ” í•¨ìˆ˜
print(fruits_inverse.shape)
# (300, 10000)

fruits_reconstruct = fruits_inverse.reshape(-1, 100, 100)
for start in [0, 100, 200]:
    draw_fruits(fruits_reconstruct[start:start+100])
    print("\n")
```
![alt text](/assets/img_20240824/image-24.png)

â—ì£¼ì„±ë¶„ì„ ìµœëŒ€ë¡œ ì‚¬ìš©í–ˆë‹¤ë©´ ì™„ë²½í•˜ê²Œ ì›ë³¸ ë°ì´í„° ì¬êµ¬ì„± ê°€ëŠ¥!

### ì„¤ëª…ëœ ë¶„ì‚°

- ì„¤ëª…ëœ ë¶„ì‚°: ì£¼ì„±ë¶„ì´ ì›ë³¸ ë°ì´í„°ì˜ ë¶„ì‚°ì„ ì–¼ë§ˆë‚˜ ì˜ ë‚˜íƒ€ë‚´ëŠ”ì§€ ê¸°ë¡í•œ ê°’.

```py
print(np.sum(pca.explained_variance_ratio_))
# explained_variance_ratio_: ê° ì£¼ì„±ë¶„ì˜ ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ì´ ê¸°ë¡ë˜ì–´ ìˆìŒ. ì´ ë¶„ì‚° ë¹„ìœ¨ì„ ëª¨ë‘ ë”í•˜ë©´ ì´ ë¶„ì‚° ë¹„ìœ¨ì´ ë‚˜ì˜´.
# 0.921510012593063

plt.plot(pca.explained_variance_ratio_)
# ì„¤ëª…ëœ ë¶„ì‚°ì˜ ë¹„ìœ¨ì„ ê·¸ë˜í”„ë¡œ ê·¸ë ¤ë³´ì.
```
![alt text](/assets/img_20240824/image-25.png)

### ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ê¸°

#### ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸


â—ê³¼ì¼ ì‚¬ì§„ ì›ë³¸ ë°ì´í„°ì™€ PCAë¡œ ì¶•ì†Œí•œ ë°ì´í„°ë¥¼ ì§€ë„ í•™ìŠµì— ì ìš©í•´ ë³´ê³  ì–´ë–¤ ì°¨ì´ê°€ ìˆëŠ”ì§€ ë³´ì!

```py
from sklearn.linear_model import LogisticRegression

lr = LogisticRegression()

target = np.array([0]*100 + [1]*100 + [2]*100)
# íŒŒì¸ì• í”Œ:0 / ë°”ë‚˜ë‚˜:1 / ì‚¬ê³¼:2
```

ğŸ”– ì›ë³¸ ë°ì´í„° ì´ìš©

```py
from sklearn.model_selection import cross_validate
scores = cross_validate(lr, fruits_2d, target)
print(np.mean(scores['test_score']))
print(np.mean(scores['fit_time']))
# 0.9966666666666667
# 3.0091545581817627(ê° êµì°¨ ê²€ì¦ í´ë“œì˜ í›ˆë ¨ ì‹œê°„)
```

ğŸ”– PCA ì´ìš©

```py
scores = cross_validate(lr, fruits_pca, target)
print(np.mean(scores['test_score']))
print(np.mean(scores['fit_time']))
# 1.0(ìƒìŠ¹)
# 0.11161208152770996(ê°ì†Œ)
```

ğŸ”– PCA ì´ìš©(n_componentsë¥¼ 0.5ë¡œ!)
```py
pca = PCA(n_components=0.5)
# n_components: ì£¼ì„±ë¶„ì˜ ê°œìˆ˜ ëŒ€ì‹  ì›í•˜ëŠ” ì„¤ëª…ëœ ë¶„ì‚°ì˜ ë¹„ìœ¨ì„ ì…ë ¥í•  ìˆ˜ë„ ìˆìŒ. ì§€ì •ëœ ë¹„ìœ¨ì— ë„ë‹¬í•  ë•Œê¹Œì§€ ìë™ìœ¼ë¡œ ì£¼ì„±ë¶„ì„ ì°¾ìŒ.
pca.fit(fruits_2d)

print(pca.n_components_)
# 2

fruits_pca = pca.transform(fruits_2d)
print(fruits_pca.shape)
# (300, 2)

scores = cross_validate(lr, fruits_pca, target)
print(np.mean(scores['test_score']))
print(np.mean(scores['fit_time']))
# 0.9933333333333334
# 0.06778483390808106(ê°ì†Œ)
```

#### K-í‰ê·  ì•Œê³ ë¦¬ì¦˜

```py
from sklearn.cluster import KMeans
km = KMeans(n_clusters=3, random_state=42)
km.fit(fruits_pca)
print(np.unique(km.labels_, return_counts = True))
# (array([0, 1, 2], dtype=int32), array([110,  99,  91]))

for label in range(0, 3):
    draw_fruits([km.labels_==label])
    print("\n")
```

![alt text](/assets/img_20240824/image-26.png)

ğŸ”– ì‚°ì ë„ ê·¸ë¦¬ê¸°

- ì°¨ì›ì„ ì¤„ì´ë©´ ì‹œê°í™” í•˜ê¸° í¸í•´ì§.

```py
for label in range(0, 3):
    data = fruits_pca[km.labels_ == label]
    plt.scatter(data[:,0], data[:,1])
plt.legend(['pineapple','banana','apple'])
plt.show()
```
![alt text](/assets/img_20240824/image-27.png)