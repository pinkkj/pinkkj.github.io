---
# Header
title: "4ì¥. ëª¨ë¸ í›ˆë ¨"
excerpt: "4ì¥. ëª¨ë¸ í›ˆë ¨"
name: J
writer: J
categories: [ì±… ì •ë¦¬, í•¸ì¦ˆì˜¨ ë¨¸ì‹ ëŸ¬ë‹] # [ë©”ì¸ ì¹´í…Œê³ ë¦¬, ì„œë¸Œ ì¹´í…Œê³ ë¦¬]
tags:
  - []

toc: true
toc_sticky: true

date: 2025-03-02
last_modified_at: 2024-03-02

# --- ì•„ë˜ ë¶€í„° content
---

ğŸ”–ì„ í˜• íšŒê·€ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ë‘ ê°€ì§€ ë°©ì•ˆ
1. ë‹«íŒ í˜•íƒœì˜ ë°©ì •ì‹ì„ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨ ì„¸íŠ¸ì— ê°€ì¥ ì˜ ë§ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„°(ì¦‰, í›ˆë ¨ ì„¸íŠ¸ì— ëŒ€í•´ ë¹„ìš© í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„°)ë¥¼ ì§ì ‘ ê³„ì‚°í•œë‹¤.
2. ê²½ì‚¬ í•˜ê°•ë²•ì´ë¼ ë¶ˆë¦¬ëŠ” ë°˜ë³µì ì¸ ìµœì í™” ë°©ì‹ì„ ì´ìš©í•˜ì—¬ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ê¸ˆì”© ë°”ê¾¸ë©´ì„œ ë¹„ìš© í•¨ìˆ˜ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì— ëŒ€í•´ ìµœì†Œí™”ì‹œí‚¨ë‹¤. ê²°êµ­ì—ëŠ” ì•ì˜ ë°©ë²•ê³¼ ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¡œ ìˆ˜ë µí•œë‹¤.

# 4.1 ì„ í˜• íšŒê·€

![alt text](/assets/img_20250311/image-13.png)
- yëŠ” ì˜ˆì¸¡ê°’
- nì€ íŠ¹ì„±ì˜ ìˆ˜
- xiëŠ” ië²ˆì§¸ íŠ¹ì„± ê°’
- WjëŠ” jë²ˆì§¸ ëª¨ë¸ íŒŒë¼ë¯¸í„°
- bëŠ” í¸í–¥

![alt text](/assets/img_20250311/image-14.png)

- hëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•œ ê°€ì„¤ í•¨ìˆ˜
- Î¸ëŠ” í¸í–¥ Î¸0ì™€ ê°€ì¤‘ì¹˜ Î¸1, Î¸2,Î¸3,â€¦,Î¸n ê¹Œì§€ì˜ íŠ¹ì„± ê°€ì¤‘ì¹˜ë¥¼ ë‹´ì€ ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„° ë²¡í„°
- xëŠ” íŠ¹ì„± ë²¡í„°. x0ëŠ” í•­ìƒ 1ì…ë‹ˆë‹¤.
- Î¸x: ë²¡í„° Î¸ì™€ xì˜ ì ê³±(dot product)

ğŸ”–í•™ìŠµ
- RMSEë‚˜ MSEë¥¼ ìµœì†Œí™”í•˜ëŠ” Î¸ì°¾ê¸°

![alt text](/assets/img_20250311/image-15.png)

### 4.1.1 ì •ê·œ ë°©ì •ì‹

- ë¹„ìš© í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” Î¸ë¥¼ ì°¾ê¸°ìœ„í•œ **í•´ì„ì  ë°©ë²•**ì—ì„œ ì´ìš©í•˜ëŠ” ìˆ˜í•™ ê³µì‹.

![alt text](/assets/img_20250311/image-16.png)

```py
import numpy as np

np.random.seed(42)  # ì½”ë“œ ì˜ˆì œë¥¼ ì¬í˜„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´
m = 100  # ìƒ˜í”Œ ê°œìˆ˜
X = 2 * np.random.rand(m, 1)  # ì—´ ë²¡í„°
y = 4 + 3 * X + np.random.randn(m, 1)  # ì—´ ë²¡í„°
```
![alt text](/assets/img_20250311/image-17.png)

ğŸ”–ì •ê·œ ë°©ì •ì‹ì„ ì‚¬ìš©í•˜ì—¬ ìµœì†Œí™”í•˜ëŠ” Î¸êµ¬í•¨

```py
from sklearn.preprocessing import add_dummy_feature

X_b = add_dummy_feature(X)  # ê° ìƒ˜í”Œì— x0 = 1ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
theta_best = np.linalg.inv(X_b.T @ X_b) @ X_b.T @ y
# inv() í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì—­í–‰ë ¬ì„ ê³„ì‚°í•˜ê³  dot() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ í–‰ë ¬ ê³±ì…ˆ ìˆ˜í–‰.
# @ì—°ì‚°ìëŠ” í–‰ë ¬ ê³±ì…ˆì„ ìˆ˜í–‰.

theta_best
# array([[4.21509616],
#     [2.77011339]])
```

ğŸ”–ëª¨ë¸ ì˜ˆì¸¡ ë‚˜íƒ€ë‚´ë³´ê¸°

```py
import matplotlib.pyplot as plt

plt.figure(figsize=(6, 4))  # ì¶”ê°€ ì½”ë“œ
plt.plot(X_new, y_predict, "r-", label="Predictions")
plt.plot(X, y, "b.")

# ì¶”ê°€ ì½”ë“œ - ê·¸ë¦¼ 4-2ë¥¼ ê¾¸ë¯¸ê³  ì €ì¥í•©ë‹ˆë‹¤.
plt.xlabel("$x_1$")
plt.ylabel("$y$", rotation=0)
plt.axis([0, 2, 0, 15])
plt.grid()
plt.legend(loc="upper left")
save_fig("linear_model_predictions_plot")

plt.show()
```
![alt text](/assets/img_20250311/image-18.png)

ğŸ”–ì‚¬ì´í‚·ëŸ°ì—ì„œ ì„ í˜• íšŒê·€ ìˆ˜í–‰

```py
from sklearn.linear_model import LinearRegression

lin_reg = LinearRegression()
lin_reg.fit(X, y)
lin_reg.intercept_, lin_reg.coef_
# (array([4.21509616]), array([[2.77011339]]))
lin_reg.predict(X_new)
# array([[4.21509616],
#     [9.75532293]])
```

ì§ì ‘ í˜¸ì¶œë„ ê°€ëŠ¥!

```py
theta_best_svd, residuals, rank, s = np.linalg.lstsq(X_b, y, rcond=1e-6)
theta_best_svd
# array([[4.21509616],
#     [2.77011339]])
```

ì´ í•¨ìˆ˜ëŠ” $\mathbf{X}^+\mathbf{y}$ì„ ê³„ì‚°í•©ë‹ˆë‹¤. $\mathbf{X}^{+}$ëŠ” $\mathbf{X}$ì˜ _ìœ ì‚¬ì—­í–‰ë ¬_ (pseudoinverse)ì…ë‹ˆë‹¤(Mooreâ€“Penrose ìœ ì‚¬ì—­í–‰ë ¬ì…ë‹ˆë‹¤). `np.linalg.pinv()`ì„ ì‚¬ìš©í•´ì„œ ìœ ì‚¬ì—­í–‰ë ¬ì„ ì§ì ‘ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

```py
np.linalg.pinv(X_b) @ y
# array([[4.21509616],
#     [2.77011339]])
```

ìœ ì‚¬í–‰ë ¬ ìì²´ëŠ” **íŠ¹ì‡ê°’ ë¶„í•´**ë¼ ë¶€ë¥´ëŠ” í‘œì¤€ í–‰ë ¬ ë¶„í•´ ê¸°ë²•ì„ ì‚¬ìš©í•´ ê³„ì‚°í•œë‹¤. SVDëŠ” í›ˆë ¨ ì„¸íŠ¸ í–‰ë ¬ Xë¥¼ 3ê°œì˜ í–‰ë ¬ ê³±ì…ˆ  U * Sigma * V^Të¡œ ë¶„í•´í•©ë‹ˆë‹¤. ìœ ì‚¬ì—­í–‰ë ¬ì€ X+ = V * Sigma+ * U^T ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤. sigma+ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì•Œê³ ë¦¬ì¦˜ì´ sigmaë¥¼ ë¨¼ì € êµ¬í•œ ë‹¤ìŒ ì–´ë–¤ ë‚®ì€ ì„ê³—ê°’ë³´ë‹¤ ì‘ì€ ëª¨ë“  ìˆ˜ë¥¼ 0ìœ¼ë¡œ ë°”ê¿‰ë‹ˆë‹¤. ê·¸ë‹¤ìŒ 0ì´ ì•„ë‹Œ ëª¨ë“  ê°’ì„ ì—­ìˆ˜ë¡œ ì¹˜í™˜í•œë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ í–‰ë ¬ì„ ì „ì¹˜í•œë‹¤. ì •ê·œ ë°©ì •ì‹ì„ ê³„ì‚°í•˜ëŠ” ê²ƒë³´ë‹¤ ì´ ë°©ì‹ì´ í›¨ì”¬ íš¨ìœ¨ì ì´ë‹¤. ë˜í•œ ê·¹ë‹¨ì ì¸ ê²½ìš°ë„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

â—m < nì´ê±°ë‚˜ ì–´ë–¤ íŠ¹ì„±ì´ ì¤‘ë³µë˜ì–´ í–‰ë ¬ $\mathbf{X}^t\mathbf{X}$ì˜ ì—­í–‰ë ¬ì´ ì—†ë‹¤ë©´(ì¦‰, íŠ¹ì´ í–‰ë ¬ì´ë¼ë©´) ì •ê·œ ë°©ì •ì‹ì´ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ ìœ ì‚¬ì—­í–‰ë ¬ì€ í•­ìƒ êµ¬í•  ìˆ˜ ìˆë‹¤.

### 4.1.2 ê³„ì‚° ë³µì¡ë„

